## QUẢN LÝ CẤU HÌNH
DANH_SACH_CAU_HINH=SELECT * FROM CAU_HINH
DANH_SACH_CAU_HINH_NHOM=SELECT * FROM CAU_HINH WHERE NHOM=?
CAP_NHAT_CAU_HINH=UPDATE CAU_HINH SET GIA_TRI=? WHERE MA=?
LAY_CAU_HINH=SELECT * FROM CAU_HINH WHERE MA=?

## QUẢN LÝ BẢNG CÂN ĐỐI KẾ TOÁN
DANH_SACH_GOC_BCDKT=SELECT * FROM BALANCE_ASSET_ITEM WHERE ASSET_PARENT IS NULL OR ASSET_PARENT='' ORDER BY ASSET_CODE
DANH_SACH_CON_BCDKT=SELECT * FROM BALANCE_ASSET_ITEM WHERE ASSET_PARENT = ? ORDER BY ASSET_CODE
DANH_SACH_CON_TKKT=SELECT TKKT.*, CDKT.SO_DU AS SO_DU_GIA_TRI, CDKT.MA_TK_GOC FROM CDKT_TAIKHOAN AS CDKT, TAI_KHOAN_DANH_MUC AS TKKT WHERE CDKT.MA_TK=TKKT.MA_TK AND CDKT.ASSET_CODE = ? ORDER BY TKKT.MA_TK

## CẬP NHẬT BẢNG CÂN ĐỐI KẾ TOÁN
DANH_SACH_TKKT_THUOC_NHIEU_CHI_TIEU=SELECT MA_TK, SO_DU AS SO_DU_GIA_TRI FROM CDKT_TAIKHOAN GROUP BY MA_TK, SO_DU HAVING COUNT(*)>1
DANH_SACH_CDKT_THEO_TKKT=SELECT * FROM BALANCE_ASSET_ITEM WHERE ASSET_CODE IN (SELECT DISTINCT ASSET_CODE FROM CDKT_TAIKHOAN WHERE MA_TK=? AND SO_DU=?)
LAY_CDKT_DAU_KY=SELECT START_VALUE FROM BALANCE_ASSET_DATA WHERE ASSET_CODE=? AND PERIOD_TYPE=? AND PERIOD=?
LAY_CDKT_CUOI_KY=SELECT END_VALUE FROM BALANCE_ASSET_DATA WHERE ASSET_CODE=? AND PERIOD_TYPE=? AND PERIOD=?

## Lấy giá trị chỉ tiêu cấp thấp nhất
TINH_CDKT_THEO_MATK_1=SELECT DUNO.ASSET_CODE, DUNO.MA_TK, DUNO.DAU AS SO_DU, (DUNO.SO_TIEN*DUNO.SO_DU+DUCO.SO_TIEN*DUCO.SO_DU)*DUNO.DAU AS SO_TIEN \
	FROM (SELECT CDKT.ASSET_CODE, CDKT.MA_TK, NVKT.SO_DU, SUM(NVKT.SO_TIEN) AS SO_TIEN, CDKT.SO_DU AS DAU \
		FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, CDKT_TAIKHOAN AS CDKT, TAI_KHOAN_DANH_MUC AS TKDM \
		WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND SUBSTRING(NVKT.MA_TK, 1, LENGTH(CDKT.MA_TK))=CDKT.MA_TK \
			AND TKDM.LUONG_TINH=0 AND NVKT.SO_DU=-1 AND CT.NGAY_HT >= ? AND CT.NGAY_HT <= ? \
		GROUP BY CDKT.ASSET_CODE, CDKT.MA_TK) AS DUNO, \
		(SELECT CDKT.ASSET_CODE, CDKT.MA_TK, NVKT.SO_DU, SUM(NVKT.SO_TIEN) AS SO_TIEN, CDKT.SO_DU AS DAU \
		FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, CDKT_TAIKHOAN AS CDKT, TAI_KHOAN_DANH_MUC AS TKDM \
		WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND SUBSTRING(NVKT.MA_TK, 1, LENGTH(CDKT.MA_TK))=CDKT.MA_TK \
			AND TKDM.LUONG_TINH=0 AND NVKT.SO_DU=1 AND CT.NGAY_HT >= ? AND CT.NGAY_HT <= ? \
		GROUP BY CDKT.ASSET_CODE, CDKT.MA_TK) AS DUCO \
	WHERE DUNO.ASSET_CODE=DUCO.ASSET_CODE AND DUNO.MA_TK=DUCO.MA_TK \
	UNION \
	SELECT CDKT.ASSET_CODE, CDKT.MA_TK, CDKT.SO_DU, SUM(NVKT.SO_TIEN) AS SO_TIEN \
	FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, CDKT_TAIKHOAN AS CDKT, TAI_KHOAN_DANH_MUC AS TKDM \
	WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND SUBSTRING(NVKT.MA_TK, 1, LENGTH(CDKT.MA_TK))=CDKT.MA_TK \
			AND TKDM.LUONG_TINH=1 AND CDKT.SO_DU=NVKT.SO_DU AND CT.NGAY_HT >= ? AND CT.NGAY_HT <= ? \
		GROUP BY CDKT.ASSET_CODE, CDKT.MA_TK
TINH_CDKT_THEO_MATK_2=SELECT DUNO.ASSET_CODE, DUNO.MA_TK, DUNO.DAU AS SO_DU, (DUNO.SO_TIEN+DUCO.SO_TIEN)*DUNO.DAU AS SO_TIEN \
	FROM (SELECT CDKT.ASSET_CODE, CDKT.MA_TK, NVKT.SO_DU, SUM(NVKT.SO_TIEN*NVKT.SO_DU*TKDM.SO_DU) AS SO_TIEN, CDKT.SO_DU AS DAU \
		FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, CDKT_TAIKHOAN AS CDKT, TAI_KHOAN_DANH_MUC AS TKDM \
		WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND SUBSTRING(NVKT.MA_TK, 1, LENGTH(CDKT.MA_TK))=CDKT.MA_TK \
			AND TKDM.LUONG_TINH=0 AND NVKT.SO_DU=-1 AND CT.NGAY_HT >= ? AND CT.NGAY_HT <= ? \
		GROUP BY CDKT.ASSET_CODE, CDKT.MA_TK) AS DUNO, \
		(SELECT CDKT.ASSET_CODE, CDKT.MA_TK, NVKT.SO_DU, SUM(NVKT.SO_TIEN*NVKT.SO_DU*TKDM.SO_DU) AS SO_TIEN, CDKT.SO_DU AS DAU \
		FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, CDKT_TAIKHOAN AS CDKT, TAI_KHOAN_DANH_MUC AS TKDM \
		WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND SUBSTRING(NVKT.MA_TK, 1, LENGTH(CDKT.MA_TK))=CDKT.MA_TK \
			AND TKDM.LUONG_TINH=0 AND NVKT.SO_DU=1 AND CT.NGAY_HT >= ? AND CT.NGAY_HT <= ? \
		GROUP BY CDKT.ASSET_CODE, CDKT.MA_TK) AS DUCO \
	WHERE DUNO.ASSET_CODE=DUCO.ASSET_CODE AND DUNO.MA_TK=DUCO.MA_TK \
	UNION \
	SELECT CDKT.ASSET_CODE, CDKT.MA_TK, CDKT.SO_DU, SUM(NVKT.SO_TIEN*CDKT.SO_DU) AS SO_TIEN \
	FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, CDKT_TAIKHOAN AS CDKT, TAI_KHOAN_DANH_MUC AS TKDM \
	WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND SUBSTRING(NVKT.MA_TK, 1, LENGTH(CDKT.MA_TK))=CDKT.MA_TK \
			AND TKDM.LUONG_TINH=1 AND CDKT.SO_DU=NVKT.SO_DU AND CT.NGAY_HT >= ? AND CT.NGAY_HT <= ? \
		GROUP BY CDKT.ASSET_CODE, CDKT.MA_TK

TINH_CDKT_DAU_KY=SELECT KETQUA.ASSET_CODE, SUM(KETQUA.SO_TIEN) AS SO_TIEN \
		FROM (SELECT DUNO.ASSET_CODE, DUNO.MA_TK, (DUNO.SO_TIEN+DUCO.SO_TIEN)*DUNO.DAU*DUNO.SO_DU AS SO_TIEN \
			FROM (SELECT CDKT.ASSET_CODE, CDKT.MA_TK, SUM(KKTSD.NO_DAU_KY*-1*TKDM.SO_DU) AS SO_TIEN, CDKT.SO_DU AS DAU, BAI.SO_DU \
				FROM CDKT_TAIKHOAN AS CDKT, BALANCE_ASSET_ITEM AS BAI, TAI_KHOAN_DANH_MUC AS TKDM, KY_KE_TOAN AS KKT, KY_KE_TOAN_SO_DU AS KKTSD \
				WHERE CDKT.ASSET_CODE=BAI.ASSET_CODE AND CDKT.MA_TK=TKDM.MA_TK AND TKDM.LUONG_TINH=0 \
					AND KKT.MA_KKT=KKTSD.MA_KKT AND KKT.MA_KKT=? AND KKTSD.MA_DT=0 AND KKTSD.LOAI_DT=0 AND KKTSD.MA_HH=0 AND KKTSD.MA_KHO=0 \
					AND CDKT.MA_TK=KKTSD.MA_TK \
				GROUP BY CDKT.ASSET_CODE, CDKT.MA_TK) AS DUNO, \
				(SELECT CDKT.ASSET_CODE, CDKT.MA_TK, SUM(KKTSD.CO_DAU_KY*1*TKDM.SO_DU) AS SO_TIEN, CDKT.SO_DU AS DAU, BAI.SO_DU \
				FROM CDKT_TAIKHOAN AS CDKT, BALANCE_ASSET_ITEM AS BAI, TAI_KHOAN_DANH_MUC AS TKDM, KY_KE_TOAN AS KKT, KY_KE_TOAN_SO_DU AS KKTSD \
				WHERE CDKT.ASSET_CODE=BAI.ASSET_CODE AND CDKT.MA_TK=TKDM.MA_TK AND TKDM.LUONG_TINH=0 \
					AND KKT.MA_KKT=KKTSD.MA_KKT AND KKT.MA_KKT=? AND KKTSD.MA_DT=0 AND KKTSD.LOAI_DT=0 AND KKTSD.MA_HH=0 AND KKTSD.MA_KHO=0 \
					AND CDKT.MA_TK=KKTSD.MA_TK \
				GROUP BY CDKT.ASSET_CODE, CDKT.MA_TK) AS DUCO \
			WHERE DUNO.ASSET_CODE=DUCO.ASSET_CODE AND DUNO.MA_TK=DUCO.MA_TK \
			UNION \
			SELECT CDKT.ASSET_CODE, CDKT.MA_TK, SUM(KKTSD.NO_DAU_KY*CDKT.SO_DU*BAI.SO_DU) AS SO_TIEN \
				FROM CDKT_TAIKHOAN AS CDKT, BALANCE_ASSET_ITEM AS BAI, TAI_KHOAN_DANH_MUC AS TKDM, KY_KE_TOAN AS KKT, KY_KE_TOAN_SO_DU AS KKTSD \
				WHERE CDKT.ASSET_CODE=BAI.ASSET_CODE AND CDKT.MA_TK=TKDM.MA_TK AND TKDM.LUONG_TINH=1 AND CDKT.SO_DU=-1 \
					AND KKT.MA_KKT=KKTSD.MA_KKT AND KKT.MA_KKT=? AND KKTSD.MA_DT=0 AND KKTSD.LOAI_DT=0 AND KKTSD.MA_HH=0 AND KKTSD.MA_KHO=0 \
					AND CDKT.MA_TK=KKTSD.MA_TK \
				GROUP BY CDKT.ASSET_CODE, CDKT.MA_TK \
			UNION \
			SELECT CDKT.ASSET_CODE, CDKT.MA_TK, SUM(KKTSD.CO_DAU_KY*CDKT.SO_DU*BAI.SO_DU) AS SO_TIEN \
				FROM CDKT_TAIKHOAN AS CDKT, BALANCE_ASSET_ITEM AS BAI, TAI_KHOAN_DANH_MUC AS TKDM, KY_KE_TOAN AS KKT, KY_KE_TOAN_SO_DU AS KKTSD \
				WHERE CDKT.ASSET_CODE=BAI.ASSET_CODE AND CDKT.MA_TK=TKDM.MA_TK AND TKDM.LUONG_TINH=1 AND CDKT.SO_DU=1 \
					AND KKT.MA_KKT=KKTSD.MA_KKT AND KKT.MA_KKT=? AND KKTSD.MA_DT=0 AND KKTSD.LOAI_DT=0 AND KKTSD.MA_HH=0 AND KKTSD.MA_KHO=0 \
					AND CDKT.MA_TK=KKTSD.MA_TK \
				GROUP BY CDKT.ASSET_CODE, CDKT.MA_TK) AS KETQUA \
		GROUP BY KETQUA.ASSET_CODE

TINH_CDKT_PHAT_SINH=SELECT KETQUA.ASSET_CODE, SUM(KETQUA.SO_TIEN) AS SO_TIEN \
		FROM (SELECT DUNO.ASSET_CODE, DUNO.MA_TK, (DUNO.SO_TIEN+DUCO.SO_TIEN)*DUNO.DAU*DUNO.SO_DU AS SO_TIEN \
			FROM (SELECT CDKT.ASSET_CODE, CDKT.MA_TK, SUM(NVKT.SO_TIEN*NVKT.SO_DU*TKDM.SO_DU) AS SO_TIEN, CDKT.SO_DU AS DAU, BAI.SO_DU \
				FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, CDKT_TAIKHOAN AS CDKT, BALANCE_ASSET_ITEM AS BAI, TAI_KHOAN_DANH_MUC AS TKDM \
				WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND SUBSTRING(NVKT.MA_TK, 1, LENGTH(CDKT.MA_TK))=CDKT.MA_TK \
					AND TKDM.LUONG_TINH=0 AND NVKT.SO_DU=-1 AND CDKT.ASSET_CODE=BAI.ASSET_CODE AND CT.NGAY_HT >=? AND CT.NGAY_HT <=? \
				GROUP BY CDKT.ASSET_CODE, CDKT.MA_TK) AS DUNO, \
				(SELECT CDKT.ASSET_CODE, CDKT.MA_TK, SUM(NVKT.SO_TIEN*NVKT.SO_DU*TKDM.SO_DU) AS SO_TIEN, CDKT.SO_DU AS DAU, BAI.SO_DU \
				FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, CDKT_TAIKHOAN AS CDKT, BALANCE_ASSET_ITEM AS BAI, TAI_KHOAN_DANH_MUC AS TKDM \
				WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND SUBSTRING(NVKT.MA_TK, 1, LENGTH(CDKT.MA_TK))=CDKT.MA_TK \
					AND TKDM.LUONG_TINH=0 AND NVKT.SO_DU=1 AND CDKT.ASSET_CODE=BAI.ASSET_CODE AND CT.NGAY_HT >=? AND CT.NGAY_HT <=? \
				GROUP BY CDKT.ASSET_CODE, CDKT.MA_TK) AS DUCO \
			WHERE DUNO.ASSET_CODE=DUCO.ASSET_CODE AND DUNO.MA_TK=DUCO.MA_TK \
			UNION \
			SELECT CDKT.ASSET_CODE, CDKT.MA_TK, SUM(NVKT.SO_TIEN*CDKT.SO_DU*BAI.SO_DU) AS SO_TIEN \
			FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, CDKT_TAIKHOAN AS CDKT, BALANCE_ASSET_ITEM AS BAI, TAI_KHOAN_DANH_MUC AS TKDM \
			WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND SUBSTRING(NVKT.MA_TK, 1, LENGTH(CDKT.MA_TK))=CDKT.MA_TK \
					AND TKDM.LUONG_TINH=1 AND CDKT.SO_DU=NVKT.SO_DU AND CDKT.ASSET_CODE=BAI.ASSET_CODE AND CT.NGAY_HT >=? AND CT.NGAY_HT <=? \
				GROUP BY CDKT.ASSET_CODE, CDKT.MA_TK) AS KETQUA \
		GROUP BY KETQUA.ASSET_CODE

TINH_CDKT_CUOI_KY=SELECT KETQUA.ASSET_CODE, SUM(KETQUA.SO_TIEN) AS SO_TIEN \
		FROM (SELECT DUNO.ASSET_CODE, DUNO.MA_TK, (DUNO.SO_TIEN+DUCO.SO_TIEN)*DUNO.DAU*DUNO.SO_DU AS SO_TIEN \
			FROM (SELECT CDKT.ASSET_CODE, CDKT.MA_TK, SUM(NVKT.SO_TIEN*NVKT.SO_DU*TKDM.SO_DU) AS SO_TIEN, CDKT.SO_DU AS DAU, BAI.SO_DU \
				FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, CDKT_TAIKHOAN AS CDKT, BALANCE_ASSET_ITEM AS BAI, TAI_KHOAN_DANH_MUC AS TKDM \
				WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND SUBSTRING(NVKT.MA_TK, 1, LENGTH(CDKT.MA_TK))=CDKT.MA_TK \
					AND TKDM.LUONG_TINH=0 AND NVKT.SO_DU=-1 AND CDKT.ASSET_CODE=BAI.ASSET_CODE AND CT.NGAY_HT >=? AND CT.NGAY_HT <=? \
				GROUP BY CDKT.ASSET_CODE, CDKT.MA_TK) AS DUNO, \
				(SELECT CDKT.ASSET_CODE, CDKT.MA_TK, SUM(NVKT.SO_TIEN*NVKT.SO_DU*TKDM.SO_DU) AS SO_TIEN, CDKT.SO_DU AS DAU, BAI.SO_DU \
				FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, CDKT_TAIKHOAN AS CDKT, BALANCE_ASSET_ITEM AS BAI, TAI_KHOAN_DANH_MUC AS TKDM \
				WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND SUBSTRING(NVKT.MA_TK, 1, LENGTH(CDKT.MA_TK))=CDKT.MA_TK \
					AND TKDM.LUONG_TINH=0 AND NVKT.SO_DU=1 AND CDKT.ASSET_CODE=BAI.ASSET_CODE AND CT.NGAY_HT >=? AND CT.NGAY_HT <=? \
				GROUP BY CDKT.ASSET_CODE, CDKT.MA_TK) AS DUCO \
			WHERE DUNO.ASSET_CODE=DUCO.ASSET_CODE AND DUNO.MA_TK=DUCO.MA_TK \
			UNION \
			SELECT CDKT.ASSET_CODE, CDKT.MA_TK, SUM(NVKT.SO_TIEN*CDKT.SO_DU*BAI.SO_DU) AS SO_TIEN \
			FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, CDKT_TAIKHOAN AS CDKT, BALANCE_ASSET_ITEM AS BAI, TAI_KHOAN_DANH_MUC AS TKDM \
			WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND SUBSTRING(NVKT.MA_TK, 1, LENGTH(CDKT.MA_TK))=CDKT.MA_TK \
					AND TKDM.LUONG_TINH=1 AND CDKT.SO_DU=NVKT.SO_DU AND CDKT.ASSET_CODE=BAI.ASSET_CODE AND CT.NGAY_HT >=? AND CT.NGAY_HT <=? \
				GROUP BY CDKT.ASSET_CODE, CDKT.MA_TK \
			UNION \
			SELECT DUNO.ASSET_CODE, DUNO.MA_TK, (DUNO.SO_TIEN+DUCO.SO_TIEN)*DUNO.DAU*DUNO.SO_DU AS SO_TIEN \
			FROM (SELECT CDKT.ASSET_CODE, CDKT.MA_TK, SUM(KKTSD.NO_DAU_KY*-1*TKDM.SO_DU) AS SO_TIEN, CDKT.SO_DU AS DAU, BAI.SO_DU \
				FROM CDKT_TAIKHOAN AS CDKT, BALANCE_ASSET_ITEM AS BAI, TAI_KHOAN_DANH_MUC AS TKDM, KY_KE_TOAN AS KKT, KY_KE_TOAN_SO_DU AS KKTSD \
				WHERE CDKT.ASSET_CODE=BAI.ASSET_CODE AND CDKT.MA_TK=TKDM.MA_TK AND TKDM.LUONG_TINH=0 \
					AND KKT.MA_KKT=KKTSD.MA_KKT AND KKT.MA_KKT=? AND KKTSD.MA_DT=0 AND KKTSD.LOAI_DT=0 AND KKTSD.MA_HH=0 AND KKTSD.MA_KHO=0 \
					AND CDKT.MA_TK=KKTSD.MA_TK \
				GROUP BY CDKT.ASSET_CODE, CDKT.MA_TK) AS DUNO, \
				(SELECT CDKT.ASSET_CODE, CDKT.MA_TK, SUM(KKTSD.CO_DAU_KY*1*TKDM.SO_DU) AS SO_TIEN, CDKT.SO_DU AS DAU, BAI.SO_DU \
				FROM CDKT_TAIKHOAN AS CDKT, BALANCE_ASSET_ITEM AS BAI, TAI_KHOAN_DANH_MUC AS TKDM, KY_KE_TOAN AS KKT, KY_KE_TOAN_SO_DU AS KKTSD \
				WHERE CDKT.ASSET_CODE=BAI.ASSET_CODE AND CDKT.MA_TK=TKDM.MA_TK AND TKDM.LUONG_TINH=0 \
					AND KKT.MA_KKT=KKTSD.MA_KKT AND KKT.MA_KKT=? AND KKTSD.MA_DT=0 AND KKTSD.LOAI_DT=0 AND KKTSD.MA_HH=0 AND KKTSD.MA_KHO=0 \
					AND CDKT.MA_TK=KKTSD.MA_TK \
				GROUP BY CDKT.ASSET_CODE, CDKT.MA_TK) AS DUCO \
			WHERE DUNO.ASSET_CODE=DUCO.ASSET_CODE AND DUNO.MA_TK=DUCO.MA_TK \
			UNION \
			SELECT CDKT.ASSET_CODE, CDKT.MA_TK, SUM(KKTSD.NO_DAU_KY*CDKT.SO_DU*BAI.SO_DU) AS SO_TIEN \
				FROM CDKT_TAIKHOAN AS CDKT, BALANCE_ASSET_ITEM AS BAI, TAI_KHOAN_DANH_MUC AS TKDM, KY_KE_TOAN AS KKT, KY_KE_TOAN_SO_DU AS KKTSD \
				WHERE CDKT.ASSET_CODE=BAI.ASSET_CODE AND CDKT.MA_TK=TKDM.MA_TK AND TKDM.LUONG_TINH=1 AND CDKT.SO_DU=-1 \
					AND KKT.MA_KKT=KKTSD.MA_KKT AND KKT.MA_KKT=? AND KKTSD.MA_DT=0 AND KKTSD.LOAI_DT=0 AND KKTSD.MA_HH=0 AND KKTSD.MA_KHO=0 \
					AND CDKT.MA_TK=KKTSD.MA_TK \
				GROUP BY CDKT.ASSET_CODE, CDKT.MA_TK \
			UNION \
			SELECT CDKT.ASSET_CODE, CDKT.MA_TK, SUM(KKTSD.CO_DAU_KY*CDKT.SO_DU*BAI.SO_DU) AS SO_TIEN \
				FROM CDKT_TAIKHOAN AS CDKT, BALANCE_ASSET_ITEM AS BAI, TAI_KHOAN_DANH_MUC AS TKDM, KY_KE_TOAN AS KKT, KY_KE_TOAN_SO_DU AS KKTSD \
				WHERE CDKT.ASSET_CODE=BAI.ASSET_CODE AND CDKT.MA_TK=TKDM.MA_TK AND TKDM.LUONG_TINH=1 AND CDKT.SO_DU=1 \
					AND KKT.MA_KKT=KKTSD.MA_KKT AND KKT.MA_KKT=? AND KKTSD.MA_DT=0 AND KKTSD.LOAI_DT=0 AND KKTSD.MA_HH=0 AND KKTSD.MA_KHO=0 \
					AND CDKT.MA_TK=KKTSD.MA_TK \
				GROUP BY CDKT.ASSET_CODE, CDKT.MA_TK) AS KETQUA \
		GROUP BY KETQUA.ASSET_CODE
KIEM_TRA_SINH_BS_1=SELECT COUNT(*) FROM BALANCE_ASSET_DATA WHERE PERIOD=? AND PERIOD_TYPE=?
KIEM_TRA_SINH_BS_2=SELECT COUNT(*) FROM BALANCE_ASSET_ITEM

# Mối quan hệ chỉ tiêu CĐKT & tài khoản
THEM_CHI_TIEU_CDKT_TAI_KHOAN=INSERT INTO CDKT_TAIKHOAN(ASSET_CODE, MA_TK, MA_TK_GOC, SO_DU) VALUES(?, ?, ?, ?)
CAP_NHAT_CHI_TIEU_CDKT_TAI_KHOAN=UPDATE CDKT_TAIKHOAN SET MA_TK=? WHERE ASSET_CODE=? AND MA_TK=?
LAY_CHI_TIEU_CDKT_TAI_KHOAN=SELECT BAI.ASSET_CODE, BAI.ASSET_NAME, BAI.SO_DU, TKDM.MA_TK, TKDM.TEN_TK, CDKT.SO_DU AS SO_DU_GIA_TRI, CDKT.MA_TK_GOC FROM BALANCE_ASSET_ITEM AS BAI, CDKT_TAIKHOAN AS CDKT, TAI_KHOAN_DANH_MUC AS TKDM WHERE BAI.ASSET_CODE=CDKT.ASSET_CODE AND TKDM.MA_TK=CDKT.MA_TK AND BAI.ASSET_CODE=? AND CDKT.MA_TK=?
XOA_CHI_TIEU_CDKT_TAI_KHOAN=DELETE FROM CDKT_TAIKHOAN WHERE ASSET_CODE=? AND MA_TK=?

# QUẢN LÝ BẢNG KẾT QUẢ HOẠT ĐỘNG KINH DOANH 
DANH_SACH_GOC_BKQHDKD=SELECT * FROM SALE_RESULT_ITEM WHERE ASSET_PARENT IS NULL OR ASSET_PARENT='' ORDER BY ASSET_CODE
DANH_SACH_CON_BKQHDKD=SELECT * FROM SALE_RESULT_ITEM WHERE ASSET_PARENT = ? ORDER BY ASSET_CODE
DANH_SACH_CON_KQHDKD_TKKT=SELECT TKKT.*, KQHDKDKT.SO_DU AS SO_DU_GIA_TRI FROM KQHDKD_TAIKHOAN AS KQHDKDKT, TAI_KHOAN_DANH_MUC AS TKKT WHERE KQHDKDKT.MA_TK=TKKT.MA_TK AND KQHDKDKT.ASSET_CODE = ? ORDER BY TKKT.MA_TK

LAY_KQHDKD_DAU_KY=SELECT START_VALUE FROM SALE_RESULT_DATA WHERE ASSET_CODE=? AND PERIOD_TYPE=? AND PERIOD=?
LAY_KQHDKD_CUOI_KY=SELECT END_VALUE FROM SALE_RESULT_DATA WHERE ASSET_CODE=? AND PERIOD_TYPE=? AND PERIOD=?
TINH_KQHDKD_THEO_MATK_1=SELECT KQHDKD.ASSET_CODE, KQHDKD.MA_TK, KQHDKD.SO_DU, SUM(NVKT.SO_TIEN) AS SO_TIEN \
	FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, CHUNG_TU_NVKT AS CTNVKT_DU, NGHIEP_VU_KE_TOAN AS NVKT, NGHIEP_VU_KE_TOAN AS NVKT_DU, KQHDKD_TAIKHOAN AS KQHDKD \
	WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND KQHDKD.SO_DU=NVKT.SO_DU AND SUBSTRING(NVKT.MA_TK, 1, LENGTH(KQHDKD.MA_TK))=KQHDKD.MA_TK \
		AND CT.MA_CT=CTNVKT_DU.MA_CT AND CTNVKT_DU.MA_NVKT=NVKT_DU.MA_NVKT AND KQHDKD.SO_DU=0-NVKT_DU.SO_DU AND CTNVKT.NHOM_DK=CTNVKT_DU.NHOM_DK \
		AND CT.NGAY_HT >= ? AND CT.NGAY_HT <= ? \
		AND ((KQHDKD.ASSET_CODE IN ('02') AND (KQHDKD.MA_TK='511' AND SUBSTRING(NVKT_DU.MA_TK, 1, 3)='521') AND CTNVKT.MA_KC=CTNVKT_DU.MA_KC) OR \
			(KQHDKD.ASSET_CODE IN ('11') AND (KQHDKD.MA_TK='632' AND SUBSTRING(NVKT_DU.MA_TK, 1, 3)='911') AND CTNVKT.MA_KC=CTNVKT_DU.MA_KC) OR \
			(KQHDKD.ASSET_CODE IN ('21') AND (KQHDKD.MA_TK='515' AND SUBSTRING(NVKT_DU.MA_TK, 1, 3)='911') AND CTNVKT.MA_KC=CTNVKT_DU.MA_KC) OR \
			(KQHDKD.ASSET_CODE IN ('22') AND (KQHDKD.MA_TK='635' AND SUBSTRING(NVKT_DU.MA_TK, 1, 3)='911') AND CTNVKT.MA_KC=CTNVKT_DU.MA_KC) OR \
			(KQHDKD.ASSET_CODE IN ('25') AND (KQHDKD.MA_TK='641' AND SUBSTRING(NVKT_DU.MA_TK, 1, 3)='911') AND CTNVKT.MA_KC=CTNVKT_DU.MA_KC) OR \
			(KQHDKD.ASSET_CODE IN ('26') AND (KQHDKD.MA_TK='642' AND SUBSTRING(NVKT_DU.MA_TK, 1, 3)='911') AND CTNVKT.MA_KC=CTNVKT_DU.MA_KC) OR \
			(KQHDKD.ASSET_CODE IN ('31') AND (KQHDKD.MA_TK='711' AND SUBSTRING(NVKT_DU.MA_TK, 1, 3)='911') AND CTNVKT.MA_KC=CTNVKT_DU.MA_KC) OR \
			(KQHDKD.ASSET_CODE IN ('32') AND (KQHDKD.MA_TK='811' AND SUBSTRING(NVKT_DU.MA_TK, 1, 3)='911') AND CTNVKT.MA_KC=CTNVKT_DU.MA_KC) OR \
			(KQHDKD.ASSET_CODE IN ('51') AND (KQHDKD.MA_TK='8211' AND SUBSTRING(NVKT_DU.MA_TK, 1, 3)='911') AND CTNVKT.MA_KC=CTNVKT_DU.MA_KC) OR \
			(KQHDKD.ASSET_CODE IN ('52') AND (KQHDKD.MA_TK='8212' AND SUBSTRING(NVKT_DU.MA_TK, 1, 3)='911') AND CTNVKT.MA_KC=CTNVKT_DU.MA_KC) OR \
			(KQHDKD.ASSET_CODE NOT IN ('02', '11', '21', '22', '25', '26', '31', '32', '51', '52'))) \
	GROUP BY KQHDKD.ASSET_CODE, KQHDKD.MA_TK, KQHDKD.SO_DU \
	ORDER BY KQHDKD.ASSET_CODE, KQHDKD.MA_TK, KQHDKD.SO_DU
TINH_KQHDKD_THEO_MATK=SELECT KQHDKD.ASSET_CODE, SUM(NVKT.SO_TIEN) AS SO_TIEN \
	FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, CHUNG_TU_NVKT AS CTNVKT_DU, NGHIEP_VU_KE_TOAN AS NVKT, NGHIEP_VU_KE_TOAN AS NVKT_DU, KQHDKD_TAIKHOAN AS KQHDKD \
	WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND KQHDKD.SO_DU=NVKT.SO_DU AND SUBSTRING(NVKT.MA_TK, 1, LENGTH(KQHDKD.MA_TK))=KQHDKD.MA_TK \
		AND CT.MA_CT=CTNVKT_DU.MA_CT AND CTNVKT_DU.MA_NVKT=NVKT_DU.MA_NVKT AND KQHDKD.SO_DU=0-NVKT_DU.SO_DU AND CTNVKT.NHOM_DK=CTNVKT_DU.NHOM_DK \
		AND CT.NGAY_HT >= ? AND CT.NGAY_HT <= ? \
		AND ((KQHDKD.ASSET_CODE IN ('02') AND SUBSTRING(NVKT_DU.MA_TK, 1, 3)='521' AND CTNVKT.MA_KC=CTNVKT_DU.MA_KC) OR \
			(KQHDKD.ASSET_CODE IN ('11') AND SUBSTRING(NVKT_DU.MA_TK, 1, 3)='911' AND CTNVKT.MA_KC=CTNVKT_DU.MA_KC) OR \
			(KQHDKD.ASSET_CODE IN ('21') AND SUBSTRING(NVKT_DU.MA_TK, 1, 3)='911' AND CTNVKT.MA_KC=CTNVKT_DU.MA_KC) OR \
			(KQHDKD.ASSET_CODE IN ('22') AND SUBSTRING(NVKT_DU.MA_TK, 1, 3)='911' AND CTNVKT.MA_KC=CTNVKT_DU.MA_KC) OR \
			(KQHDKD.ASSET_CODE IN ('25') AND SUBSTRING(NVKT_DU.MA_TK, 1, 3)='911' AND CTNVKT.MA_KC=CTNVKT_DU.MA_KC) OR \
			(KQHDKD.ASSET_CODE IN ('26') AND SUBSTRING(NVKT_DU.MA_TK, 1, 3)='911' AND CTNVKT.MA_KC=CTNVKT_DU.MA_KC) OR \
			(KQHDKD.ASSET_CODE IN ('31') AND SUBSTRING(NVKT_DU.MA_TK, 1, 3)='911' AND CTNVKT.MA_KC=CTNVKT_DU.MA_KC) OR \
			(KQHDKD.ASSET_CODE IN ('32') AND SUBSTRING(NVKT_DU.MA_TK, 1, 3)='911' AND CTNVKT.MA_KC=CTNVKT_DU.MA_KC) OR \
			(KQHDKD.ASSET_CODE IN ('51') AND SUBSTRING(NVKT_DU.MA_TK, 1, 3)='911' AND CTNVKT.MA_KC=CTNVKT_DU.MA_KC) OR \
			(KQHDKD.ASSET_CODE IN ('52') AND SUBSTRING(NVKT_DU.MA_TK, 1, 3)='911' AND CTNVKT.MA_KC=CTNVKT_DU.MA_KC) OR \
			(KQHDKD.ASSET_CODE NOT IN ('02', '11', '21', '22', '25', '26', '31', '32', '51', '52'))) \
	GROUP BY KQHDKD.ASSET_CODE \
	ORDER BY KQHDKD.ASSET_CODE

# QUẢN LÝ BẢNG LƯU CHUYỂN TIỀN TỆ
DANH_SACH_GOC_BLCTT=SELECT * FROM CASH_FLOW_ITEM WHERE ASSET_PARENT IS NULL OR ASSET_PARENT='' ORDER BY ASSET_CODE
DANH_SACH_CON_BLCTT=SELECT * FROM CASH_FLOW_ITEM WHERE ASSET_PARENT = ? ORDER BY ASSET_CODE
DANH_SACH_CON_BLCTT_TKKT=SELECT TKKT.*, LCTTKT.SO_DU AS SO_DU_GIA_TRI, LCTTKT.MA_TK_DU, TKKT_DU.TEN_TK AS TEN_TK_DU, 0-LCTTKT.SO_DU AS SO_DU_GIA_TRI_DU, TKKT_DU.MA_TK_CHA AS MA_TK_CHA_DU, TKKT_DU.LUONG_TINH AS LUONG_TINH_DU, TKKT_DU.SO_DU AS SO_DU_DU  \
	FROM CASH_FLOW_TAIKHOAN AS LCTTKT, TAI_KHOAN_DANH_MUC AS TKKT, TAI_KHOAN_DANH_MUC AS TKKT_DU \
	WHERE LCTTKT.MA_TK=TKKT.MA_TK AND LCTTKT.MA_TK_DU=TKKT_DU.MA_TK AND LCTTKT.ASSET_CODE = ? \
	ORDER BY TKKT.MA_TK

LAY_LCTT_DAU_KY=SELECT START_VALUE FROM CASH_FLOW_DATA WHERE ASSET_CODE=? AND PERIOD_TYPE=? AND PERIOD=?
LAY_LCTT_CUOI_KY=SELECT END_VALUE FROM CASH_FLOW_DATA WHERE ASSET_CODE=? AND PERIOD_TYPE=? AND PERIOD=?
# Lưu ý câu query này chỉ đúng nếu nhóm định khoản chuẩn, hiện tại cần phải thay SUM(NVKT.SO_TIEN) thành SUM(LEAST(NVKT.SO_TIEN, NVKT_DU.SO_TIEN)) mới chuẩn, sau này đổi lại
TINH_LCTT_THEO_MATK_1=SELECT LCTT.ASSET_CODE, LCTT.MA_TK, LCTT.SO_DU, SUM(LEAST(NVKT.SO_TIEN, NVKT_DU.SO_TIEN)) AS SO_TIEN \
	FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, CHUNG_TU_NVKT AS CTNVKT_DU, NGHIEP_VU_KE_TOAN AS NVKT, NGHIEP_VU_KE_TOAN AS NVKT_DU, CASH_FLOW_TAIKHOAN AS LCTT \
	WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND LCTT.SO_DU=NVKT.SO_DU AND SUBSTRING(NVKT.MA_TK, 1, LENGTH(LCTT.MA_TK))=LCTT.MA_TK \
		AND CT.MA_CT=CTNVKT_DU.MA_CT AND CTNVKT_DU.MA_NVKT=NVKT_DU.MA_NVKT AND LCTT.SO_DU=0-NVKT_DU.SO_DU AND CTNVKT.NHOM_DK=CTNVKT_DU.NHOM_DK \
		AND SUBSTRING(NVKT_DU.MA_TK, 1, LENGTH(LCTT.MA_TK_DU))=LCTT.MA_TK_DU AND CT.NGAY_HT >= ? AND CT.NGAY_HT <= ? \
	GROUP BY LCTT.ASSET_CODE, LCTT.MA_TK, LCTT.SO_DU \
	ORDER BY LCTT.ASSET_CODE, LCTT.MA_TK, LCTT.SO_DU
TINH_LCTT_THEO_MATK=SELECT LCTT.ASSET_CODE, SUM(LEAST(NVKT.SO_TIEN, NVKT_DU.SO_TIEN) * NVKT_DU.SO_DU) AS SO_TIEN \
	FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, CHUNG_TU_NVKT AS CTNVKT_DU, NGHIEP_VU_KE_TOAN AS NVKT, NGHIEP_VU_KE_TOAN AS NVKT_DU, CASH_FLOW_TAIKHOAN AS LCTT \
	WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND LCTT.SO_DU=NVKT.SO_DU AND SUBSTRING(NVKT.MA_TK, 1, LENGTH(LCTT.MA_TK))=LCTT.MA_TK \
		AND CT.MA_CT=CTNVKT_DU.MA_CT AND CTNVKT_DU.MA_NVKT=NVKT_DU.MA_NVKT AND LCTT.SO_DU=0-NVKT_DU.SO_DU AND CTNVKT.NHOM_DK=CTNVKT_DU.NHOM_DK \
		AND SUBSTRING(NVKT_DU.MA_TK, 1, LENGTH(LCTT.MA_TK_DU))=LCTT.MA_TK_DU AND CT.NGAY_HT >= ? AND CT.NGAY_HT <= ? \
	GROUP BY LCTT.ASSET_CODE \
	ORDER BY LCTT.ASSET_CODE

# Mối quan hệ chỉ tiêu LCTT & tài khoản
THEM_CHI_TIEU_LCTT_TAI_KHOAN=INSERT INTO CASH_FLOW_TAIKHOAN(ASSET_CODE, MA_TK, SO_DU, MA_TK_DU) VALUES(?, ?, ?, ?)
XOA_CHI_TIEU_LCTT_TAI_KHOAN=DELETE FROM CASH_FLOW_TAIKHOAN WHERE ASSET_CODE=? AND MA_TK=? AND SO_DU=? AND MA_TK_DU=?

## QUẢN LÝ CHỨNG TỪ
## Phần quản lý phiếu thu, phiếu chi, báo nợ, báo có, kế toán tổng hợp (gọi chung là chứng từ)
DANH_SACH_CHUNG_TU_THEO_LOAI= \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.KEM_THEO, CT.LOAI_TIEN, CT.TY_GIA, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, '' AS KH_DT, CT_DT.FULL_NAME COLLATE utf8_general_ci AS TEN_DT , '' AS MA_THUE, CT_DT.DEPARTMENT COLLATE utf8_general_ci AS DIA_CHI, NVKT.MA_NVKT, NVKT.MA_TK, NVKT.SO_TIEN, NVKT.SO_DU, NVKT.LY_DO AS TK_LY_DO, TKDM.TEN_TK, NT.TEN_NT \
	FROM CHUNG_TU AS CT, EMPLOYEE_INFO AS CT_DT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, TAI_KHOAN_DANH_MUC AS TKDM, NGOAI_TE AS NT \
	WHERE CT.MA_CT=CTNVKT.MA_CT $DIEU_KIEN_LOAI_CT$ AND CT.MA_DT=CT_DT.EMPLOYEE_ID AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND CT.LOAI_DT=1 AND NGAY_HT>=? AND NGAY_HT<=? \
	UNION \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.KEM_THEO, CT.LOAI_TIEN, CT.TY_GIA, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, CT_DT.KH_KH AS KH_DT, CT_DT.TEN_KH AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, NVKT.MA_NVKT, NVKT.MA_TK, NVKT.SO_TIEN, NVKT.SO_DU, NVKT.LY_DO AS TK_LY_DO, TKDM.TEN_TK, NT.TEN_NT \
	FROM CHUNG_TU AS CT, KHACH_HANG AS CT_DT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, TAI_KHOAN_DANH_MUC AS TKDM, NGOAI_TE AS NT \
	WHERE CT.MA_CT=CTNVKT.MA_CT $DIEU_KIEN_LOAI_CT$ AND CT.MA_DT=CT_DT.MA_KH AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND CT.LOAI_DT IN (2, 4) AND NGAY_HT>=? AND NGAY_HT<=? \
	UNION \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.KEM_THEO, CT.LOAI_TIEN, CT.TY_GIA, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, CT_DT.KH_NCC AS KH_DT, CT_DT.TEN_NCC AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, NVKT.MA_NVKT, NVKT.MA_TK, NVKT.SO_TIEN, NVKT.SO_DU, NVKT.LY_DO AS TK_LY_DO, TKDM.TEN_TK, NT.TEN_NT \
	FROM CHUNG_TU AS CT, NHA_CUNG_CAP AS CT_DT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, TAI_KHOAN_DANH_MUC AS TKDM, NGOAI_TE AS NT \
	WHERE CT.MA_CT=CTNVKT.MA_CT $DIEU_KIEN_LOAI_CT$ AND CT.MA_DT=CT_DT.MA_NCC AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND CT.LOAI_DT=3 AND NGAY_HT>=? AND NGAY_HT<=? \
	ORDER BY NGAY_HT DESC, MA_CT

DANH_SACH_CHUNG_TU_THEO_LOAI_KTTH= \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.KEM_THEO, CT.LOAI_TIEN, CT.TY_GIA, CTNVKT.NHOM_DK, NVKT.MA_NVKT, NVKT.MA_TK, NVKT.SO_TIEN, NVKT.SO_DU, NVKT.LY_DO AS TK_LY_DO, TKDM.TEN_TK, NT.TEN_NT, NVKT.MA_DT, NVKT.LOAI_DT, CT_DT.KH_DT, CT_DT.TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI \
	FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, TAI_KHOAN_DANH_MUC AS TKDM, NGOAI_TE AS NT, NGHIEP_VU_KE_TOAN AS NVKT \
		LEFT JOIN (SELECT EM.EMPLOYEE_ID AS MA_DT, 1 AS LOAI_DT, NULL AS KH_DT, EM.FULL_NAME COLLATE utf8_general_ci AS TEN_DT , NULL AS MA_THUE, EM.DEPARTMENT COLLATE utf8_general_ci AS DIA_CHI FROM EMPLOYEE_INFO AS EM \
			UNION SELECT KH.MA_KH AS MA_DT, 2 AS LOAI_DT, KH.KH_KH AS KH_DT, KH.TEN_KH AS TEN_DT, KH.MA_THUE, KH.DIA_CHI FROM KHACH_HANG AS KH \
			UNION SELECT NCC.MA_NCC AS MA_DT, 3 AS LOAI_DT, NCC.KH_NCC AS KH_DT, NCC.TEN_NCC AS TEN_DT, NCC.MA_THUE, NCC.DIA_CHI FROM NHA_CUNG_CAP AS NCC ) AS CT_DT \
		ON NVKT.MA_DT=CT_DT.MA_DT AND NVKT.LOAI_DT=CT_DT.LOAI_DT \
	WHERE CT.MA_CT=CTNVKT.MA_CT $DIEU_KIEN_LOAI_CT$ AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND NGAY_HT>=? AND NGAY_HT<=? \
	ORDER BY NGAY_HT DESC, MA_CT

DANH_SACH_CHUNG_TU_KHO_THEO_LOAI= \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.KEM_THEO, CT.LOAI_TIEN, CT.TY_GIA, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, \
		'' AS KH_DT, CT_DT.FULL_NAME COLLATE utf8_general_ci AS TEN_DT , '' AS MA_THUE, CT_DT.DEPARTMENT COLLATE utf8_general_ci AS DIA_CHI, \
		HH.MA_HH, HH.KH_HH, HH.TEN_HH, HHDV.MA_DV, HHDV.TEN_DV, HHN.MA_NHOM_HH, HHN.KH_NHOM_HH, HHN.TEN_NHOM_HH, CTHH.SO_LUONG_CT, CTHH.SO_LUONG_TN, CTHH.DON_GIA, \
		CTHH.CHIEU, HHG.DON_GIA AS GIA_KHO, HHG.MA_GIA AS MA_GIA_KHO, NVKT.MA_NVKT, NVKT.MA_TK, NVKT.SO_TIEN, NVKT.SO_DU, NVKT.LY_DO AS TK_LY_DO, TKDM.TEN_TK, NT.TEN_NT, \
		CTK.MA_KHO, CTK.KH_KHO, CTK.TEN_KHO, CTK.DIA_CHI, CTK.MO_TA, CTNVKT.NHOM_DK, CTNVKT.LOAI_TK, CTNVKT.THUE_SUAT \
	FROM CHUNG_TU AS CT, EMPLOYEE_INFO AS CT_DT, CHUNG_TU_HANG_HOA AS CTHH, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, HANG_HOA_DANH_MUC AS HH, \
		HANG_HOA_DON_VI AS HHDV, HANG_HOA_NHOM AS HHN, HANG_HOA_KHO AS CTK, HANG_HOA_GIA AS HHG, TAI_KHOAN_DANH_MUC AS TKDM, NGOAI_TE AS NT \
	WHERE CT.MA_CT=CTHH.MA_CT AND CT.MA_CT=CTNVKT.MA_CT AND CT.LOAI_TIEN=NT.MA_NT AND CTHH.MA_KHO=CTK.MA_KHO AND CTHH.MA_HH=CTNVKT.MA_HH \
		AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND CTHH.MA_HH=HH.MA_HH AND HH.MA_DV=HHDV.MA_DV AND HH.MA_NHOM_HH=HHN.MA_NHOM_HH AND NVKT.MA_TK=TKDM.MA_TK \
		AND HHG.MA_GIA=CTHH.MA_GIA_KHO AND CT.MA_DT=CT_DT.EMPLOYEE_ID AND CT.LOAI_DT=1 $DIEU_KIEN_LOAI_CT$ AND NGAY_HT>=? AND NGAY_HT<=? \
	UNION \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.KEM_THEO, CT.LOAI_TIEN, CT.TY_GIA, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, \
		CT_DT.KH_KH AS KH_DT, CT_DT.TEN_KH AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, HH.MA_HH, HH.KH_HH, HH.TEN_HH, HHDV.MA_DV, HHDV.TEN_DV, HHN.MA_NHOM_HH, HHN.KH_NHOM_HH, HHN.TEN_NHOM_HH, \
		CTHH.SO_LUONG_CT, CTHH.SO_LUONG_TN, CTHH.DON_GIA, CTHH.CHIEU, HHG.DON_GIA AS GIA_KHO, HHG.MA_GIA AS MA_GIA_KHO, NVKT.MA_NVKT, NVKT.MA_TK, NVKT.SO_TIEN, NVKT.SO_DU, NVKT.LY_DO AS TK_LY_DO, TKDM.TEN_TK, NT.TEN_NT, \
		CTK.MA_KHO, CTK.KH_KHO, CTK.TEN_KHO, CTK.DIA_CHI, CTK.MO_TA, CTNVKT.NHOM_DK, CTNVKT.LOAI_TK, CTNVKT.THUE_SUAT \
	FROM CHUNG_TU AS CT, KHACH_HANG AS CT_DT, CHUNG_TU_HANG_HOA AS CTHH, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, HANG_HOA_DANH_MUC AS HH, \
		HANG_HOA_DON_VI AS HHDV, HANG_HOA_NHOM AS HHN, HANG_HOA_KHO AS CTK, HANG_HOA_GIA AS HHG, TAI_KHOAN_DANH_MUC AS TKDM, NGOAI_TE AS NT \
	WHERE CT.MA_CT=CTHH.MA_CT AND CT.MA_CT=CTNVKT.MA_CT AND CT.LOAI_TIEN=NT.MA_NT AND CTHH.MA_KHO=CTK.MA_KHO AND CTHH.MA_HH=CTNVKT.MA_HH \
		AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND CTHH.MA_HH=HH.MA_HH AND HH.MA_DV=HHDV.MA_DV AND HH.MA_NHOM_HH=HHN.MA_NHOM_HH AND NVKT.MA_TK=TKDM.MA_TK \
		AND HHG.MA_GIA=CTHH.MA_GIA_KHO AND CT.MA_DT=CT_DT.MA_KH AND CT.LOAI_DT IN (2, 4) $DIEU_KIEN_LOAI_CT$ AND NGAY_HT>=? AND NGAY_HT<=? \
	UNION \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.KEM_THEO, CT.LOAI_TIEN, CT.TY_GIA, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, \
		CT_DT.KH_NCC AS KH_DT, CT_DT.TEN_NCC AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, HH.MA_HH, HH.KH_HH, HH.TEN_HH, HHDV.MA_DV, HHDV.TEN_DV, HHN.MA_NHOM_HH, HHN.KH_NHOM_HH, HHN.TEN_NHOM_HH, \
		CTHH.SO_LUONG_CT, CTHH.SO_LUONG_TN, CTHH.DON_GIA, CTHH.CHIEU, HHG.DON_GIA AS GIA_KHO, HHG.MA_GIA AS MA_GIA_KHO, NVKT.MA_NVKT, NVKT.MA_TK, NVKT.SO_TIEN, NVKT.SO_DU, NVKT.LY_DO AS TK_LY_DO, TKDM.TEN_TK, NT.TEN_NT, \
		CTK.MA_KHO, CTK.KH_KHO, CTK.TEN_KHO, CTK.DIA_CHI, CTK.MO_TA, CTNVKT.NHOM_DK, CTNVKT.LOAI_TK, CTNVKT.THUE_SUAT \
	FROM CHUNG_TU AS CT, NHA_CUNG_CAP AS CT_DT, CHUNG_TU_HANG_HOA AS CTHH, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, HANG_HOA_DANH_MUC AS HH, \
		HANG_HOA_DON_VI AS HHDV, HANG_HOA_NHOM AS HHN, HANG_HOA_KHO AS CTK, HANG_HOA_GIA AS HHG, TAI_KHOAN_DANH_MUC AS TKDM, NGOAI_TE AS NT \
	WHERE CT.MA_CT=CTHH.MA_CT AND CT.MA_CT=CTNVKT.MA_CT AND CT.LOAI_TIEN=NT.MA_NT AND CTHH.MA_KHO=CTK.MA_KHO AND CTHH.MA_HH=CTNVKT.MA_HH \
		AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND CTHH.MA_HH=HH.MA_HH AND HH.MA_DV=HHDV.MA_DV AND HH.MA_NHOM_HH=HHN.MA_NHOM_HH AND NVKT.MA_TK=TKDM.MA_TK \
		AND HHG.MA_GIA=CTHH.MA_GIA_KHO AND CT.MA_DT=CT_DT.MA_NCC AND CT.LOAI_DT=3 $DIEU_KIEN_LOAI_CT$ AND NGAY_HT>=? AND NGAY_HT<=? \
	ORDER BY NGAY_HT DESC, MA_CT

## Lấy thông tin chứng từ theo maCt và loaiCt
LAY_CHUNG_TU_THEO_MACT_LOAICT=SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.KEM_THEO, CT.LOAI_TIEN, CT.TY_GIA, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, '' AS KH_DT, CT_DT.FULL_NAME COLLATE utf8_general_ci AS TEN_DT , '' AS MA_THUE, CT_DT.DEPARTMENT COLLATE utf8_general_ci AS DIA_CHI, NVKT.MA_NVKT, NVKT.MA_TK, NVKT.SO_TIEN, NVKT.SO_DU, NVKT.LY_DO AS TK_LY_DO, TKDM.TEN_TK, NT.TEN_NT \
	FROM CHUNG_TU AS CT, EMPLOYEE_INFO AS CT_DT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, TAI_KHOAN_DANH_MUC AS TKDM, NGOAI_TE AS NT \
	WHERE CT.MA_CT=? AND CT.MA_CT=CTNVKT.MA_CT AND CT.LOAI_CT=? AND CT.MA_DT=CT_DT.EMPLOYEE_ID AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND CT.LOAI_DT=1 \
	UNION \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.KEM_THEO, CT.LOAI_TIEN, CT.TY_GIA, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, CT_DT.KH_KH AS KH_DT, CT_DT.TEN_KH AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, NVKT.MA_NVKT, NVKT.MA_TK, NVKT.SO_TIEN, NVKT.SO_DU, NVKT.LY_DO AS TK_LY_DO, TKDM.TEN_TK, NT.TEN_NT \
	FROM CHUNG_TU AS CT, KHACH_HANG AS CT_DT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, TAI_KHOAN_DANH_MUC AS TKDM, NGOAI_TE AS NT \
	WHERE CT.MA_CT=? AND CT.MA_CT=CTNVKT.MA_CT AND CT.LOAI_CT=? AND CT.MA_DT=CT_DT.MA_KH AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND CT.LOAI_DT IN (2, 4) \
	UNION \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.KEM_THEO, CT.LOAI_TIEN, CT.TY_GIA, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, CT_DT.KH_NCC AS KH_DT, CT_DT.TEN_NCC AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, NVKT.MA_NVKT, NVKT.MA_TK, NVKT.SO_TIEN, NVKT.SO_DU, NVKT.LY_DO AS TK_LY_DO, TKDM.TEN_TK, NT.TEN_NT \
	FROM CHUNG_TU AS CT, NHA_CUNG_CAP AS CT_DT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, TAI_KHOAN_DANH_MUC AS TKDM, NGOAI_TE AS NT \
	WHERE CT.MA_CT=? AND CT.MA_CT=CTNVKT.MA_CT AND CT.LOAI_CT=? AND CT.MA_DT=CT_DT.MA_NCC AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND CT.LOAI_DT=3 \
	ORDER BY NGAY_HT DESC, MA_CT

LAY_CHUNG_TU_THEO_MACT_LOAICT_KTTH= \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.KEM_THEO, CT.LOAI_TIEN, CT.TY_GIA, CTNVKT.NHOM_DK, NVKT.MA_NVKT, NVKT.MA_TK, NVKT.SO_TIEN, NVKT.SO_DU, NVKT.LY_DO AS TK_LY_DO, TKDM.TEN_TK, NT.TEN_NT, NVKT.MA_DT, NVKT.LOAI_DT, CT_DT.KH_DT, CT_DT.TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI \
	FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, TAI_KHOAN_DANH_MUC AS TKDM, NGOAI_TE AS NT, NGHIEP_VU_KE_TOAN AS NVKT \
		LEFT JOIN (SELECT EM.EMPLOYEE_ID AS MA_DT, 1 AS LOAI_DT, NULL AS KH_DT, EM.FULL_NAME COLLATE utf8_general_ci AS TEN_DT , NULL AS MA_THUE, EM.DEPARTMENT COLLATE utf8_general_ci AS DIA_CHI FROM EMPLOYEE_INFO AS EM \
			UNION SELECT KH.MA_KH AS MA_DT, 2 AS LOAI_DT, KH.KH_KH AS KH_DT, KH.TEN_KH AS TEN_DT, KH.MA_THUE, KH.DIA_CHI FROM KHACH_HANG AS KH \
			UNION SELECT NCC.MA_NCC AS MA_DT, 3 AS LOAI_DT, NCC.KH_NCC AS KH_DT, NCC.TEN_NCC AS TEN_DT, NCC.MA_THUE, NCC.DIA_CHI FROM NHA_CUNG_CAP AS NCC ) AS CT_DT \
		ON NVKT.MA_DT=CT_DT.MA_DT AND NVKT.LOAI_DT=CT_DT.LOAI_DT \
	WHERE CT.MA_CT=? AND CT.MA_CT=CTNVKT.MA_CT AND CT.LOAI_CT=? AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND CT.LOAI_TIEN=NT.MA_NT \
	ORDER BY NGAY_HT DESC, MA_CT

LAY_CHUNG_TU_KHO_THEO_MACT_LOAICT= \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.KEM_THEO, CT.LOAI_TIEN, CT.TY_GIA, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, \
		'' AS KH_DT, CT_DT.FULL_NAME COLLATE utf8_general_ci AS TEN_DT , '' AS MA_THUE, CT_DT.DEPARTMENT COLLATE utf8_general_ci AS DIA_CHI, \
		HH.MA_HH, HH.KH_HH, HH.TEN_HH, HHDV.MA_DV, HHDV.TEN_DV, HHN.MA_NHOM_HH, HHN.KH_NHOM_HH, HHN.TEN_NHOM_HH, CTHH.SO_LUONG_CT, CTHH.SO_LUONG_TN, CTHH.DON_GIA, \
		CTHH.CHIEU, HHG.DON_GIA AS GIA_KHO, HHG.MA_GIA AS MA_GIA_KHO, NVKT.MA_NVKT, NVKT.MA_TK, NVKT.SO_TIEN, NVKT.SO_DU, NVKT.LY_DO AS TK_LY_DO, TKDM.TEN_TK, NT.TEN_NT, \
		CTK.MA_KHO, CTK.KH_KHO, CTK.TEN_KHO, CTK.DIA_CHI, CTK.MO_TA, CTNVKT.NHOM_DK, CTNVKT.LOAI_TK, CTNVKT.THUE_SUAT \
	FROM CHUNG_TU AS CT, EMPLOYEE_INFO AS CT_DT, CHUNG_TU_HANG_HOA AS CTHH, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, HANG_HOA_DANH_MUC AS HH, \
		HANG_HOA_DON_VI AS HHDV, HANG_HOA_NHOM AS HHN, HANG_HOA_KHO AS CTK, HANG_HOA_GIA AS HHG, TAI_KHOAN_DANH_MUC AS TKDM, NGOAI_TE AS NT \
	WHERE CT.MA_CT=CTHH.MA_CT AND CT.MA_CT=CTNVKT.MA_CT AND CT.LOAI_TIEN=NT.MA_NT AND CTHH.MA_KHO=CTK.MA_KHO AND CTHH.MA_HH=CTNVKT.MA_HH \
		AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND CTHH.MA_HH=HH.MA_HH AND HH.MA_DV=HHDV.MA_DV AND HH.MA_NHOM_HH=HHN.MA_NHOM_HH AND NVKT.MA_TK=TKDM.MA_TK \
		AND HHG.MA_GIA=CTHH.MA_GIA_KHO AND CT.MA_DT=CT_DT.EMPLOYEE_ID AND CT.LOAI_DT=1 AND CT.MA_CT=? AND CT.LOAI_CT=? \
	UNION \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.KEM_THEO, CT.LOAI_TIEN, CT.TY_GIA, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, \
		CT_DT.KH_KH AS KH_DT, CT_DT.TEN_KH AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, HH.MA_HH, HH.KH_HH, HH.TEN_HH, HHDV.MA_DV, HHDV.TEN_DV, HHN.MA_NHOM_HH, HHN.KH_NHOM_HH, HHN.TEN_NHOM_HH, \
		CTHH.SO_LUONG_CT, CTHH.SO_LUONG_TN, CTHH.DON_GIA, CTHH.CHIEU, HHG.DON_GIA AS GIA_KHO, HHG.MA_GIA AS MA_GIA_KHO, NVKT.MA_NVKT, NVKT.MA_TK, NVKT.SO_TIEN, NVKT.SO_DU, NVKT.LY_DO AS TK_LY_DO, TKDM.TEN_TK, NT.TEN_NT, \
		CTK.MA_KHO, CTK.KH_KHO, CTK.TEN_KHO, CTK.DIA_CHI, CTK.MO_TA, CTNVKT.NHOM_DK, CTNVKT.LOAI_TK, CTNVKT.THUE_SUAT \
	FROM CHUNG_TU AS CT, KHACH_HANG AS CT_DT, CHUNG_TU_HANG_HOA AS CTHH, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, HANG_HOA_DANH_MUC AS HH, \
		HANG_HOA_DON_VI AS HHDV, HANG_HOA_NHOM AS HHN, HANG_HOA_KHO AS CTK, HANG_HOA_GIA AS HHG, TAI_KHOAN_DANH_MUC AS TKDM, NGOAI_TE AS NT \
	WHERE CT.MA_CT=CTHH.MA_CT AND CT.MA_CT=CTNVKT.MA_CT AND CT.LOAI_TIEN=NT.MA_NT AND CTHH.MA_KHO=CTK.MA_KHO AND CTHH.MA_HH=CTNVKT.MA_HH \
		AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND CTHH.MA_HH=HH.MA_HH AND HH.MA_DV=HHDV.MA_DV AND HH.MA_NHOM_HH=HHN.MA_NHOM_HH AND NVKT.MA_TK=TKDM.MA_TK \
		AND HHG.MA_GIA=CTHH.MA_GIA_KHO AND CT.MA_DT=CT_DT.MA_KH AND CT.LOAI_DT IN (2, 4) AND CT.MA_CT=? AND CT.LOAI_CT=? \
	UNION \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.KEM_THEO, CT.LOAI_TIEN, CT.TY_GIA, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, \
		CT_DT.KH_NCC AS KH_DT, CT_DT.TEN_NCC AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, HH.MA_HH, HH.KH_HH, HH.TEN_HH, HHDV.MA_DV, HHDV.TEN_DV, HHN.MA_NHOM_HH, HHN.KH_NHOM_HH, HHN.TEN_NHOM_HH, \
		CTHH.SO_LUONG_CT, CTHH.SO_LUONG_TN, CTHH.DON_GIA, CTHH.CHIEU, HHG.DON_GIA AS GIA_KHO, HHG.MA_GIA AS MA_GIA_KHO, NVKT.MA_NVKT, NVKT.MA_TK, NVKT.SO_TIEN, NVKT.SO_DU, NVKT.LY_DO AS TK_LY_DO, TKDM.TEN_TK, NT.TEN_NT, \
		CTK.MA_KHO, CTK.KH_KHO, CTK.TEN_KHO, CTK.DIA_CHI, CTK.MO_TA, CTNVKT.NHOM_DK, CTNVKT.LOAI_TK, CTNVKT.THUE_SUAT \
	FROM CHUNG_TU AS CT, NHA_CUNG_CAP AS CT_DT, CHUNG_TU_HANG_HOA AS CTHH, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, HANG_HOA_DANH_MUC AS HH, \
		HANG_HOA_DON_VI AS HHDV, HANG_HOA_NHOM AS HHN, HANG_HOA_KHO AS CTK, HANG_HOA_GIA AS HHG, TAI_KHOAN_DANH_MUC AS TKDM, NGOAI_TE AS NT \
	WHERE CT.MA_CT=CTHH.MA_CT AND CT.MA_CT=CTNVKT.MA_CT AND CT.LOAI_TIEN=NT.MA_NT AND CTHH.MA_KHO=CTK.MA_KHO AND CTHH.MA_HH=CTNVKT.MA_HH \
		AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND CTHH.MA_HH=HH.MA_HH AND HH.MA_DV=HHDV.MA_DV AND HH.MA_NHOM_HH=HHN.MA_NHOM_HH AND NVKT.MA_TK=TKDM.MA_TK \
		AND HHG.MA_GIA=CTHH.MA_GIA_KHO AND CT.MA_DT=CT_DT.MA_NCC AND CT.LOAI_DT=3 AND CT.MA_CT=? AND CT.LOAI_CT=? \
	ORDER BY NGAY_HT DESC, MA_CT
	
## Lấy thông tin chuẩn bị cho form tạo mới chứng từ
DANH_SACH_LOAI_TIEN= SELECT * FROM NGOAI_TE WHERE THEO_DOI=1 ORDER BY TEN_NT DESC

DANH_SACH_NHAN_VIEN=SELECT *, '' AS KH_NV FROM EMPLOYEE_INFO ORDER BY FULL_NAME
DANH_SACH_NHAN_VIEN_THEO_MA_HOAC_TEN=SELECT *, '' AS KH_NV FROM EMPLOYEE_INFO WHERE EMPLOYEE_ID LIKE ('%?%') OR FULL_NAME LIKE ('%?%') ORDER BY FULL_NAME

DANH_SACH_KHACH_HANG_THEO_MA_HOAC_TEN=SELECT * FROM KHACH_HANG WHERE (MA_KH LIKE ('%?%') OR TEN_KH LIKE ('%?%')) AND MA_KH!=1 ORDER BY TEN_KH
DANH_SACH_KHACH_HANG_PHAT_SINH_CHUNG_TU=SELECT DISTINCT MA_DT FROM CHUNG_TU WHERE LOAI_DT=2 AND (MA_DT IS NOT NULL AND MA_DT!=0)
DANH_SACH_KHACH_HANG_PHAT_SINH_NVKT=SELECT DISTINCT MA_DT FROM NGHIEP_VU_KE_TOAN WHERE LOAI_DT=2 AND (MA_DT IS NOT NULL AND MA_DT!=0)
KIEM_TRA_KHACH_HANG_PHAT_SINH_CHUNG_TU=SELECT COUNT(*) FROM CHUNG_TU WHERE LOAI_DT=2 AND MA_DT=?
KIEM_TRA_KHACH_HANG_PHAT_SINH_NVKT=SELECT COUNT(*) FROM NGHIEP_VU_KE_TOAN WHERE LOAI_DT=2 AND MA_DT=?

DANH_SACH_NHA_CUNG_CAP_THEO_MA_HOAC_TEN=SELECT * FROM NHA_CUNG_CAP WHERE MA_NCC LIKE ('%?%') OR TEN_NCC LIKE ('%?%') ORDER BY TEN_NCC
DANH_SACH_NHA_CUNG_CAP_PHAT_SINH_CHUNG_TU=SELECT DISTINCT MA_DT FROM CHUNG_TU WHERE LOAI_DT=3 AND (MA_DT IS NOT NULL AND MA_DT!=0)
DANH_SACH_NHA_CUNG_CAP_PHAT_SINH_NVKT=SELECT DISTINCT MA_DT FROM NGHIEP_VU_KE_TOAN WHERE LOAI_DT=3 AND (MA_DT IS NOT NULL AND MA_DT!=0)
KIEM_TRA_NHA_CUNG_CAP_PHAT_SINH_CHUNG_TU=SELECT COUNT(*) FROM CHUNG_TU WHERE LOAI_DT=3 AND MA_DT=?
KIEM_TRA_NHA_CUNG_CAP_PHAT_SINH_NVKT=SELECT COUNT(*) FROM NGHIEP_VU_KE_TOAN WHERE LOAI_DT=3 AND MA_DT=?


## Quản lý tài khoản
DANH_SACH_TAI_KHOAN_THEO_CAP1 = SELECT * FROM TAI_KHOAN_DANH_MUC WHERE MA_TK LIKE ('?%')
DANH_SACH_TAI_KHOAN_THEO_MA_TK = SELECT * FROM TAI_KHOAN_DANH_MUC WHERE MA_TK REGEXP $MA_TK_LIST$
DANH_SACH_TAI_KHOAN_THEO_MA_TK_CON = SELECT * FROM TAI_KHOAN_DANH_MUC AS TKDM WHERE SUBSTRING(?, 1, LENGTH(TKDM.MA_TK))=TKDM.MA_TK
LAY_LOAI_TAI_KHOAN_THEO_MA_TK = SELECT * FROM TAI_KHOAN_DANH_MUC WHERE MA_TK=?
DANH_SACH_TAI_KHOAN_CON_TAT_CA=SELECT DISTINCT TKDM.MA_TK, TKDM.TEN_TK, TKDM.MA_TK_CHA, TKDM.SO_DU, TKDM.LUONG_TINH, TKDM.MA_TK_NH FROM TAI_KHOAN_DANH_MUC AS TKDM WHERE TKDM.MA_TK NOT IN (SELECT DISTINCT TKDM1.MA_TK_CHA FROM TAI_KHOAN_DANH_MUC AS TKDM1 WHERE TKDM1.MA_TK_CHA IS NOT NULL)
DANH_SACH_TAI_KHOAN_CON = SELECT DISTINCT TKDM.MA_TK, TKDM.TEN_TK, TKDM.MA_TK_CHA, TKDM.SO_DU, TKDM.LUONG_TINH, TKDM.MA_TK_NH FROM TAI_KHOAN_DANH_MUC AS TKDM WHERE TKDM.MA_TK REGEXP $MA_TK_LIST$ AND \
	TKDM.MA_TK NOT IN (SELECT DISTINCT TKDM1.MA_TK_CHA FROM TAI_KHOAN_DANH_MUC AS TKDM1 WHERE TKDM1.MA_TK_CHA IS NOT NULL AND TKDM1.MA_TK_CHA REGEXP $MA_TK_LIST$)

## Đếm số chứng từ theo loại và theo năm để đánh số chứng từ
DEM_SO_CHUNG_TU=SELECT COUNT(SO_CT) FROM CHUNG_TU WHERE LOAI_CT=? AND NGAY_LAP>=? AND NGAY_LAP<=?
LAY_SO_CHUNG_TU_LON_NHAT=SELECT MAX(SO_CT) FROM CHUNG_TU WHERE LOAI_CT=? AND NGAY_LAP>=? AND NGAY_LAP<=? GROUP BY LOAI_CT
KIEM_TRA_SO_CHUNG_TU=SELECT COUNT(SO_CT) FROM CHUNG_TU WHERE LOAI_CT=? AND NGAY_LAP>=? AND NGAY_LAP<=? AND SO_CT=? GROUP BY LOAI_CT

## Thêm chứng từ
# Thêm chứng từ
THEM_CHUNG_TU=INSERT INTO CHUNG_TU(SO_CT, LOAI_CT, TINH_CHAT, NGAY_LAP, NGAY_HT, NGAY_TT, LY_DO, LOAI_TIEN, TY_GIA, KEM_THEO, MA_DT, LOAI_DT, NGUOI_NOP, NGAY_SUA, NGAY_TAO) VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, CURDATE(), CURDATE())
THEM_CHUNG_TU_KHO=INSERT INTO CHUNG_TU(SO_CT, LOAI_CT, TINH_CHAT, NGAY_LAP, NGAY_HT, NGAY_TT, LY_DO, LOAI_TIEN, TY_GIA, KEM_THEO, MA_DT, LOAI_DT, NGUOI_NOP, NGAY_SUA, NGAY_TAO) VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, CURDATE(), CURDATE())

THEM_CHUNG_TU_TAI_KHOAN=INSERT INTO CHUNG_TU_NVKT (MA_CT, MA_NVKT) VALUES(?, ?)
THEM_CHUNG_TU_TAI_KHOAN_KTTH=INSERT INTO CHUNG_TU_NVKT (MA_CT, MA_NVKT, NHOM_DK) VALUES(?, ?, ?)
THEM_CHUNG_TU_TAI_KHOAN_KHO=INSERT INTO CHUNG_TU_NVKT (MA_CT, MA_HH, MA_NVKT, NHOM_DK, LOAI_TK, THUE_SUAT) VALUES(?, ?, ?, ?, ?, ?)

CAP_NHAT_CHUNG_TU=UPDATE CHUNG_TU SET SO_CT=?, LOAI_CT=?, TINH_CHAT=?, NGAY_LAP=?, NGAY_HT=?, NGAY_TT=?, LY_DO=?, LOAI_TIEN=?, TY_GIA=?, KEM_THEO=?, MA_DT=?, LOAI_DT=?, NGUOI_NOP=?, NGAY_SUA=CURDATE() WHERE MA_CT=?
CAP_NHAT_CHUNG_TU_NVKT= UPDATE NGHIEP_VU_KE_TOAN SET MA_TK=?, SO_TIEN=?, SO_DU=?, LY_DO=? WHERE MA_NVKT=?
LAY_CHUNG_TU_TAI_KHOAN=SELECT DISTINCT MA_NVKT FROM CHUNG_TU_NVKT WHERE MA_CT=?
XOA_CHUNG_TU_NVKT=DELETE FROM CHUNG_TU_NVKT WHERE MA_CT=? AND MA_NVKT=?

# Thêm chứng từ kho
THEM_TAI_KHOAN=INSERT INTO NGHIEP_VU_KE_TOAN(MA_TK, SO_TIEN, SO_DU, LY_DO) VALUES(?, ?, ?, ?)
THEM_TAI_KHOAN_KTTH=INSERT INTO NGHIEP_VU_KE_TOAN(MA_TK, SO_TIEN, SO_DU, LY_DO, MA_DT, LOAI_DT) VALUES(?, ?, ?, ?, ?, ?)
THEM_CHUNG_TU_HANG_HOA=INSERT INTO CHUNG_TU_HANG_HOA (MA_CT, MA_HH, SO_LUONG_TN, DON_GIA, MA_GIA_KHO, CHIEU, MA_KHO) VALUES(?, ?, ?, ?, ?, ?, ?)
THEM_DON_GIA=INSERT INTO HANG_HOA_GIA (MA_HH, DON_GIA, NGAY_TAO) VALUES(?, ?, ?)
KIEM_TRA_DON_GIA=SELECT MA_GIA FROM HANG_HOA_GIA WHERE MA_HH=? AND DON_GIA=?

CAP_NHAT_CHUNG_TU_KHO=UPDATE CHUNG_TU SET SO_CT=?, LOAI_CT=?, TINH_CHAT=?, NGAY_LAP=?, NGAY_HT=?, NGAY_TT=?, LY_DO=?, LOAI_TIEN=?, TY_GIA=?, KEM_THEO=?, MA_DT=?, LOAI_DT=?, NGUOI_NOP=?, NGAY_SUA=CURDATE() WHERE MA_CT=?
XOA_CHUNG_TU_HANG_HOA= DELETE FROM CHUNG_TU_HANG_HOA WHERE MA_CT=?
XOA_CHUNG_TU_NVKT_KHO=DELETE FROM CHUNG_TU_NVKT WHERE MA_CT=?
XOA_NVKT=DELETE FROM NGHIEP_VU_KE_TOAN WHERE MA_NVKT=?

#Nhập kho & Xuất kho
# LAY_DANH_SACH_DON_GIA=SELECT KH.MA_GIA, GIA.DON_GIA FROM HANG_HOA_KHO_HANG AS KH, HANG_HOA_GIA AS GIA WHERE KH.MA_GIA=GIA.MA_GIA AND KH.MA_HH=?
LAY_DANH_SACH_DON_GIA=SELECT DISTINCT GIA.MA_GIA, GIA.DON_GIA FROM CHUNG_TU_HANG_HOA AS CTHH, HANG_HOA_GIA AS GIA WHERE CTHH.MA_GIA_KHO=GIA.MA_GIA AND CTHH.MA_HH=?
# LAY_DANH_SACH_DON_GIA_KHO=SELECT KH.MA_GIA, GIA.DON_GIA FROM HANG_HOA_KHO_HANG AS KH, HANG_HOA_GIA AS GIA WHERE KH.MA_GIA=GIA.MA_GIA AND KH.MA_HH=? AND KH.MA_KHO=?
LAY_DANH_SACH_DON_GIA_KHO=SELECT DISTINCT GIA.MA_GIA, GIA.DON_GIA FROM CHUNG_TU_HANG_HOA AS CTHH, HANG_HOA_GIA AS GIA WHERE CTHH.MA_GIA_KHO=GIA.MA_GIA AND CTHH.MA_HH=? AND CTHH.MA_KHO=?
KIEM_TRA_KHO=SELECT SO_LUONG FROM HANG_HOA_KHO_HANG AS KH, HANG_HOA_GIA AS GIA WHERE KH.MA_GIA=GIA.MA_GIA AND KH.MA_HH=? AND KH.MA_KHO=? AND KH.MA_GIA=?
THEM_NHAP_KHO=INSERT INTO HANG_HOA_KHO_HANG(MA_HH, MA_KHO, MA_GIA, SO_LUONG, NGAY_TAO, NGAY_SUA) VALUES(?, ?, ?, ?, ?, ?)
SUA_NHAP_KHO=UPDATE HANG_HOA_KHO_HANG SET SO_LUONG=?, NGAY_SUA=? WHERE MA_HH=? AND MA_KHO=? AND MA_GIA=?
XOA_KHO_HANG=DELETE FROM HANG_HOA_KHO_HANG WHERE MA_HH=? AND MA_KHO=? AND MA_GIA=?

## Xóa chứng từ
XOA_CHUNG_TU_THEO_MACT_LOAICT=DELETE FROM CHUNG_TU WHERE MA_CT=? AND LOAI_CT=?


## BÚT TOÁN KẾT CHUYỂN, KẾT CHUYỂN
# BÚT TOÁN KẾT CHUYỂN TỰ ĐỘNG
DANH_SACH_KET_CHUYEN_BUT_TOAN=SELECT BTKC.*, TKDMNO.MA_TK AS MA_TK_NO, TKDMNO.TEN_TK AS TEN_TK_NO, TKDMNO.SO_DU AS SO_DU_NO, TKDMNO.LUONG_TINH AS LUONG_TINH_NO, TKDMCO.MA_TK AS MA_TK_CO, TKDMCO.TEN_TK AS TEN_TK_CO, TKDMCO.SO_DU AS SO_DU_CO, TKDMCO.LUONG_TINH AS LUONG_TINH_CO \
	FROM BUT_TOAN_KET_CHUYEN AS BTKC, TAI_KHOAN_DANH_MUC AS TKDMNO, TAI_KHOAN_DANH_MUC AS TKDMCO  WHERE BTKC.MA_TK_NO=TKDMNO.MA_TK AND BTKC.MA_TK_CO=TKDMCO.MA_TK ORDER BY BTKC.LOAI_KC, BTKC.THU_TU, BTKC.MA_KC
DANH_SACH_KET_CHUYEN_BUT_TOAN_THEO_LOAI=SELECT BTKC.*, TKDMNO.MA_TK AS MA_TK_NO, TKDMNO.TEN_TK AS TEN_TK_NO, TKDMNO.SO_DU AS SO_DU_NO, TKDMNO.LUONG_TINH AS LUONG_TINH_NO, TKDMCO.MA_TK AS MA_TK_CO, TKDMCO.TEN_TK AS TEN_TK_CO, TKDMCO.SO_DU AS SO_DU_CO, TKDMCO.LUONG_TINH AS LUONG_TINH_CO \
	FROM BUT_TOAN_KET_CHUYEN AS BTKC, TAI_KHOAN_DANH_MUC AS TKDMNO, TAI_KHOAN_DANH_MUC AS TKDMCO  WHERE BTKC.MA_TK_NO=TKDMNO.MA_TK AND BTKC.MA_TK_CO=TKDMCO.MA_TK AND BTKC.LOAI_KC=? ORDER BY BTKC.LOAI_KC, BTKC.THU_TU, BTKC.MA_KC
THEM_KET_CHUYEN_BUT_TOAN=INSERT INTO BUT_TOAN_KET_CHUYEN(TEN_KC, MA_TK_NO, MA_TK_CO, CONG_THUC, MO_TA, THU_TU, LOAI_KC) VALUES(?, ?, ?, ?, ?, ?, ?)
CAP_NHAT_KET_CHUYEN_BUT_TOAN=UPDATE BUT_TOAN_KET_CHUYEN SET TEN_KC=?, MA_TK_NO=?, MA_TK_CO=?, CONG_THUC=?, MO_TA=?, THU_TU=?, LOAI_KC=? WHERE MA_KC=?
LAY_KET_CHUYEN_BUT_TOAN=SELECT BTKC.*, TKDMNO.MA_TK AS MA_TK_NO, TKDMNO.TEN_TK AS TEN_TK_NO, TKDMNO.SO_DU AS SO_DU_NO, TKDMNO.LUONG_TINH AS LUONG_TINH_NO, TKDMCO.MA_TK AS MA_TK_CO, TKDMCO.TEN_TK AS TEN_TK_CO, TKDMCO.SO_DU AS SO_DU_CO, TKDMCO.LUONG_TINH AS LUONG_TINH_CO \
	FROM BUT_TOAN_KET_CHUYEN AS BTKC, TAI_KHOAN_DANH_MUC AS TKDMNO, TAI_KHOAN_DANH_MUC AS TKDMCO  WHERE BTKC.MA_TK_NO=TKDMNO.MA_TK AND BTKC.MA_TK_CO=TKDMCO.MA_TK AND MA_KC=?
XOA_KET_CHUYEN_BUT_TOAN=DELETE FROM BUT_TOAN_KET_CHUYEN WHERE MA_KC=?

# KẾT CHUYỂN
DANH_SACH_CHUNG_TU_KET_CHUYEN= \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.LY_DO, CT.KEM_THEO, CT.LOAI_TIEN, CT.TY_GIA, NVKT.MA_NVKT, NVKT.MA_TK, NVKT.SO_TIEN, NVKT.SO_DU, NVKT.LY_DO AS TK_LY_DO, TKDM.TEN_TK, NT.TEN_NT, BTKC.MA_KC, BTKC.TEN_KC, BTKC.CONG_THUC, BTKC.MO_TA, BTKC.THU_TU, BTKC.LOAI_KC \
	FROM CHUNG_TU AS CT, BUT_TOAN_KET_CHUYEN AS BTKC, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, TAI_KHOAN_DANH_MUC AS TKDM, NGOAI_TE AS NT \
	WHERE CT.MA_CT=CTNVKT.MA_CT AND CT.LOAI_CT=? AND CTNVKT.MA_KC=BTKC.MA_KC AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND NGAY_HT>=? AND NGAY_HT<=? \
	ORDER BY CT.NGAY_HT DESC, THU_TU

LAY_CHUNG_TU_KET_CHUYEN= \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.LY_DO, CT.KEM_THEO, CT.LOAI_TIEN, CT.TY_GIA, NVKT.MA_NVKT, NVKT.MA_TK, NVKT.SO_TIEN, NVKT.SO_DU, NVKT.LY_DO AS TK_LY_DO, TKDM.TEN_TK, NT.TEN_NT, BTKC.MA_KC, BTKC.TEN_KC, BTKC.CONG_THUC, BTKC.MO_TA, BTKC.THU_TU, BTKC.LOAI_KC \
	FROM CHUNG_TU AS CT, BUT_TOAN_KET_CHUYEN AS BTKC, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, TAI_KHOAN_DANH_MUC AS TKDM, NGOAI_TE AS NT \
	WHERE CT.MA_CT=CTNVKT.MA_CT AND CT.LOAI_CT=? AND CTNVKT.MA_KC=BTKC.MA_KC AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND CT.MA_CT=?

LAY_NGAY_KET_CHUYEN_GAN_NHAT=SELECT MAX(NGAY_HT) FROM CHUNG_TU WHERE LOAI_CT=? AND TINH_CHAT=? AND NGAY_HT>=? AND NGAY_HT<=?

THEM_CHUNG_TU_KET_CHUYEN=INSERT INTO CHUNG_TU(SO_CT, LOAI_CT, TINH_CHAT, NGAY_LAP, NGAY_HT, LY_DO, LOAI_TIEN, TY_GIA, NGAY_SUA, NGAY_TAO) VALUES(?, ?, ?, ?, ?, ?, ?, ?, CURDATE(), CURDATE())
THEM_CHUNG_TU_TAI_KHOAN_KET_CHUYEN=INSERT INTO CHUNG_TU_NVKT (MA_CT, MA_KC, MA_NVKT) VALUES(?, ?, ?)

## SỔ KẾ TOÁN
# Sổ nhật ký chung
# Phần này dùng các truy vấn liệt kê danh sách của từng chứng từ cụ thể

# Sổ kế toán theo từng loại tài khoản: sổ tiền mặt (111), tiền gửi ngân hàng (112), công nợ khách hàng (131) ...
DANH_SACH_NGHIEP_VU_KE_TOAN_THEO_MA_TAI_KHOAN=SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.LOAI_TIEN, CT.TY_GIA, CT.KEM_THEO, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, '' AS KH_DT, CT_DT.FULL_NAME COLLATE UTF8_GENERAL_CI AS TEN_DT , '' AS MA_THUE, CT_DT.DEPARTMENT COLLATE UTF8_GENERAL_CI AS DIA_CHI, NVKTNO.MA_NVKT, NVKTNO.MA_TK AS MA_TK_NO, TKDMNO.TEN_TK AS TEN_TK_NO, TKDMNO.LUONG_TINH AS LUONG_TINH_NO, TKDMNO.SO_DU AS SO_DU_GOC_NO, NVKTNO.SO_TIEN AS SO_TIEN_NO, NVKTNO.LY_DO AS LY_DO_NO, NVKTCO.MA_NVKT, NVKTCO.MA_TK AS MA_TK_CO, TKDMCO.TEN_TK AS TEN_TK_CO, TKDMCO.LUONG_TINH AS LUONG_TINH_CO, TKDMCO.SO_DU AS SO_DU_GOC_CO, NVKTCO.SO_TIEN AS SO_TIEN_CO, NVKTCO.LY_DO AS LY_DO_CO, NT.TEN_NT \
		FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKTNO, NGHIEP_VU_KE_TOAN AS NVKTNO, CHUNG_TU_NVKT AS CTNVKTCO, NGHIEP_VU_KE_TOAN AS NVKTCO, EMPLOYEE_INFO AS CT_DT, TAI_KHOAN_DANH_MUC AS TKDMNO, TAI_KHOAN_DANH_MUC AS TKDMCO, NGOAI_TE AS NT \
		WHERE CT.MA_CT=CTNVKTNO.MA_CT AND CT.MA_CT=CTNVKTCO.MA_CT AND NVKTNO.SO_DU=-1 AND NVKTCO.SO_DU=1 AND CTNVKTNO.MA_NVKT=NVKTNO.MA_NVKT AND CTNVKTCO.MA_NVKT=NVKTCO.MA_NVKT AND CT.MA_DT=CT_DT.EMPLOYEE_ID AND NVKTNO.MA_TK=TKDMNO.MA_TK AND NVKTCO.MA_TK=TKDMCO.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND CT.LOAI_DT=1 AND (NVKTNO.MA_TK LIKE '?%' OR NVKTCO.MA_TK LIKE '?%') \
	UNION \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.LOAI_TIEN, CT.TY_GIA, CT.KEM_THEO, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, CT_DT.KH_KH AS KH_DT, CT_DT.TEN_KH AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, NVKTNO.MA_NVKT, NVKTNO.MA_TK AS MA_TK_NO, TKDMNO.TEN_TK AS TEN_TK_NO, TKDMNO.LUONG_TINH AS LUONG_TINH_NO, TKDMNO.SO_DU AS SO_DU_GOC_NO, NVKTNO.SO_TIEN AS SO_TIEN_NO, NVKTNO.LY_DO AS LY_DO_NO, NVKTCO.MA_NVKT, NVKTCO.MA_TK AS MA_TK_CO, TKDMCO.TEN_TK AS TEN_TK_CO, TKDMCO.LUONG_TINH AS LUONG_TINH_CO, TKDMCO.SO_DU AS SO_DU_GOC_CO, NVKTCO.SO_TIEN AS SO_TIEN_CO, NVKTCO.LY_DO AS LY_DO_CO, NT.TEN_NT \
		FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKTNO, NGHIEP_VU_KE_TOAN AS NVKTNO, CHUNG_TU_NVKT AS CTNVKTCO, NGHIEP_VU_KE_TOAN AS NVKTCO, KHACH_HANG AS CT_DT, TAI_KHOAN_DANH_MUC AS TKDMNO, TAI_KHOAN_DANH_MUC AS TKDMCO, NGOAI_TE AS NT \
		WHERE CT.MA_CT=CTNVKTNO.MA_CT AND CT.MA_CT=NVKTCO.MA_CT AND NVKTNO.SO_DU=-1 AND NVKTCO.SO_DU=1 AND CTNVKTNO.MA_NVKT=NVKTNO.MA_NVKT AND CTNVKTCO.MA_NVKT=NVKTCO.MA_NVKT AND CT.MA_DT=CT_DT.MA_KH AND NVKTCO.MA_TK=TKDMNO.MA_TK AND NVKTCO.MA_TK=TKDMCO.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND CT.LOAI_DT IN (2, 4) AND (NVKTNO.MA_TK LIKE '?%' OR NVKTCO.MA_TK LIKE '?%') \
	UNION \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.LOAI_TIEN, CT.TY_GIA, CT.KEM_THEO, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, CT_DT.KH_NCC AS KH_DT, CT_DT.TEN_NCC AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, NVKTNO.MA_NVKT, NVKTNO.MA_TK AS MA_TK_NO, TKDMNO.TEN_TK AS TEN_TK_NO, TKDMNO.LUONG_TINH AS LUONG_TINH_NO, TKDMNO.SO_DU AS SO_DU_GOC_NO, NVKTNO.SO_TIEN AS SO_TIEN_NO, NVKTNO.LY_DO AS LY_DO_NO, CTNVKTCO.MA_NVKT, NVKTCO.MA_TK AS MA_TK_CO, TKDMCO.TEN_TK AS TEN_TK_CO, TKDMCO.LUONG_TINH AS LUONG_TINH_CO, TKDMCO.SO_DU AS SO_DU_GOC_CO, NVKTCO.SO_TIEN AS SO_TIEN_CO, NVKTCO.LY_DO AS LY_DO_CO, NT.TEN_NT \
		FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKTNO, NGHIEP_VU_KE_TOAN AS NVKTNO, CHUNG_TU_NVKT AS CTNVKTCO, NGHIEP_VU_KE_TOAN AS NVKTCO, NHA_CUNG_CAP AS CT_DT, TAI_KHOAN_DANH_MUC AS TKDMNO, TAI_KHOAN_DANH_MUC AS TKDMCO, NGOAI_TE AS NT \
		WHERE CT.MA_CT=CTNVKTNO.MA_CT AND CT.MA_CT=CTNVKTCO.MA_CT AND NVKTNO.SO_DU=-1 AND NVKTCO.SO_DU=1 AND CTNVKTNO.MA_NVKT=NVKTNO.MA_NVKT AND CTNVKTCO.MA_NVKT=NVKTCO.MA_NVKT AND CT.MA_DT=CT_DT.MA_NCC AND NVKTNO.MA_TK=TKDMNO.MA_TK AND NVKTCO.MA_TK=TKDMCO.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND CT.LOAI_DT=3 AND (NVKTNO.MA_TK LIKE '?%' OR NVKTCO.MA_TK LIKE '?%') \
	ORDER BY NGAY_HT DESC, MA_CT DESC
	
DANH_SACH_NGHIEP_VU_KE_TOAN_THEO_DIEU_KIEN=SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.LOAI_TIEN, CT.TY_GIA, CT.KEM_THEO, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, '' AS KH_DT, CT_DT.FULL_NAME COLLATE UTF8_GENERAL_CI AS TEN_DT , '' AS MA_THUE, CT_DT.DEPARTMENT COLLATE UTF8_GENERAL_CI AS DIA_CHI, NVKTNO.MA_NVKT, NVKTNO.MA_TK AS MA_TK_NO, TKDMNO.TEN_TK AS TEN_TK_NO, TKDMNO.LUONG_TINH AS LUONG_TINH_NO, TKDMNO.SO_DU AS SO_DU_GOC_NO, NVKTNO.SO_TIEN AS SO_TIEN_NO, NVKTNO.LY_DO AS LY_DO_NO, NVKTCO.MA_NVKT, NVKTCO.MA_TK AS MA_TK_CO, TKDMCO.TEN_TK AS TEN_TK_CO, TKDMCO.LUONG_TINH AS LUONG_TINH_CO, TKDMCO.SO_DU AS SO_DU_GOC_CO, NVKTCO.SO_TIEN AS SO_TIEN_CO, NVKTCO.LY_DO AS LY_DO_CO, NT.TEN_NT \
		FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKTNO, NGHIEP_VU_KE_TOAN AS NVKTNO, CHUNG_TU_NVKT AS CTNVKTCO, NGHIEP_VU_KE_TOAN AS NVKTCO, EMPLOYEE_INFO AS CT_DT, TAI_KHOAN_DANH_MUC AS TKDMNO, TAI_KHOAN_DANH_MUC AS TKDMCO, NGOAI_TE AS NT \
		WHERE CT.LOAI_CT IN ('PT','PC','BC','BN') AND CT.MA_CT=CTNVKTNO.MA_CT AND CT.MA_CT=CTNVKTCO.MA_CT AND NVKTNO.SO_DU=-1 AND NVKTCO.SO_DU=1 AND CTNVKTNO.MA_NVKT=NVKTNO.MA_NVKT AND CTNVKTCO.MA_NVKT=NVKTCO.MA_NVKT AND CT.MA_DT=CT_DT.EMPLOYEE_ID AND NVKTNO.MA_TK=TKDMNO.MA_TK AND NVKTCO.MA_TK=TKDMCO.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND CT.LOAI_DT=1 AND (NVKTNO.MA_TK LIKE '$MA_TK$%' OR NVKTCO.MA_TK LIKE '$MA_TK$%') $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$ \
	UNION \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.LOAI_TIEN, CT.TY_GIA, CT.KEM_THEO, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, CT_DT.KH_KH AS KH_DT, CT_DT.TEN_KH AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, NVKTNO.MA_NVKT, NVKTNO.MA_TK AS MA_TK_NO, TKDMNO.TEN_TK AS TEN_TK_NO, TKDMNO.LUONG_TINH AS LUONG_TINH_NO, TKDMNO.SO_DU AS SO_DU_GOC_NO, NVKTNO.SO_TIEN AS SO_TIEN_NO, NVKTNO.LY_DO AS LY_DO_NO, CTNVKTCO.MA_NVKT, NVKTCO.MA_TK AS MA_TK_CO, TKDMCO.TEN_TK AS TEN_TK_CO, TKDMCO.LUONG_TINH AS LUONG_TINH_CO, TKDMCO.SO_DU AS SO_DU_GOC_CO, NVKTCO.SO_TIEN AS SO_TIEN_CO, NVKTCO.LY_DO AS LY_DO_CO, NT.TEN_NT \
		FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKTNO, NGHIEP_VU_KE_TOAN AS NVKTNO, CHUNG_TU_NVKT AS CTNVKTCO, NGHIEP_VU_KE_TOAN AS NVKTCO, KHACH_HANG AS CT_DT, TAI_KHOAN_DANH_MUC AS TKDMNO, TAI_KHOAN_DANH_MUC AS TKDMCO, NGOAI_TE AS NT \
		WHERE CT.LOAI_CT IN ('PT','PC','BC','BN') AND CT.MA_CT=CTNVKTNO.MA_CT AND CT.MA_CT=CTNVKTCO.MA_CT AND NVKTNO.SO_DU=-1 AND NVKTCO.SO_DU=1 AND CTNVKTNO.MA_NVKT=NVKTNO.MA_NVKT AND CTNVKTCO.MA_NVKT=NVKTCO.MA_NVKT AND CT.MA_DT=CT_DT.MA_KH AND NVKTNO.MA_TK=TKDMNO.MA_TK AND NVKTCO.MA_TK=TKDMCO.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND CT.LOAI_DT IN (2, 4) AND (NVKTNO.MA_TK LIKE '$MA_TK$%' OR NVKTCO.MA_TK LIKE '$MA_TK$%') $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$ \
	UNION \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.LOAI_TIEN, CT.TY_GIA, CT.KEM_THEO, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, CT_DT.KH_NCC AS KH_DT, CT_DT.TEN_NCC AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, NVKTNO.MA_NVKT, NVKTNO.MA_TK AS MA_TK_NO, TKDMNO.TEN_TK AS TEN_TK_NO, TKDMNO.LUONG_TINH AS LUONG_TINH_NO, TKDMNO.SO_DU AS SO_DU_GOC_NO, NVKTNO.SO_TIEN AS SO_TIEN_NO, NVKTNO.LY_DO AS LY_DO_NO, CTNVKTCO.MA_NVKT, NVKTCO.MA_TK AS MA_TK_CO, TKDMCO.TEN_TK AS TEN_TK_CO, TKDMCO.LUONG_TINH AS LUONG_TINH_CO, TKDMCO.SO_DU AS SO_DU_GOC_CO, NVKTCO.SO_TIEN AS SO_TIEN_CO, NVKTCO.LY_DO AS LY_DO_CO, NT.TEN_NT \
		FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKTNO, NGHIEP_VU_KE_TOAN AS NVKTNO, CHUNG_TU_NVKT AS CTNVKTCO, NGHIEP_VU_KE_TOAN AS NVKTCO, NHA_CUNG_CAP AS CT_DT, TAI_KHOAN_DANH_MUC AS TKDMNO, TAI_KHOAN_DANH_MUC AS TKDMCO, NGOAI_TE AS NT \
		WHERE CT.LOAI_CT IN ('PT','PC','BC','BN') AND CT.MA_CT=CTNVKTNO.MA_CT AND CT.MA_CT=CTNVKTCO.MA_CT AND NVKTNO.SO_DU=-1 AND NVKTCO.SO_DU=1 AND CTNVKTNO.MA_NVKT=NVKTNO.MA_NVKT AND CTNVKTCO.MA_NVKT=NVKTCO.MA_NVKT AND CT.MA_DT=CT_DT.MA_NCC AND NVKTNO.MA_TK=TKDMNO.MA_TK AND NVKTCO.MA_TK=TKDMCO.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND CT.LOAI_DT=3 AND (NVKTNO.MA_TK LIKE '$MA_TK$%' OR NVKTCO.MA_TK LIKE '$MA_TK$%') $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$ \
	ORDER BY NGAY_HT DESC, MA_CT DESC

DANH_SACH_NGHIEP_VU_KE_TOAN_KTTH_THEO_DIEU_KIEN=SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.LOAI_TIEN, CT.TY_GIA, CT.KEM_THEO, NVKTNO.MA_NVKT, NVKTNO.MA_TK AS MA_TK_NO, NVKTNO.MA_DT AS MA_DT_NO, NVKTNO.LOAI_DT AS LOAI_DT_NO, CT_DT_NO.KH_DT AS KH_DT_NO, CT_DT_NO.TEN_DT AS TEN_DT_NO, CT_DT_NO.MA_THUE AS MA_THUE_NO, CT_DT_NO.DIA_CHI AS DIA_CHI_NO, TKDMNO.TEN_TK AS TEN_TK_NO, TKDMNO.LUONG_TINH AS LUONG_TINH_NO, TKDMNO.SO_DU AS SO_DU_GOC_NO, NVKTNO.SO_TIEN AS SO_TIEN_NO, NVKTNO.LY_DO AS LY_DO_NO, NVKTCO.MA_NVKT, NVKTCO.MA_TK AS MA_TK_CO, NVKTCO.MA_DT AS MA_DT_CO, NVKTCO.LOAI_DT AS LOAI_DT_CO, CT_DT_CO.KH_DT AS KH_DT_CO, CT_DT_CO.TEN_DT AS TEN_DT_CO, CT_DT_CO.MA_THUE AS MA_THUE_CO, CT_DT_CO.DIA_CHI AS DIA_CHI_CO, TKDMCO.TEN_TK AS TEN_TK_CO, TKDMCO.LUONG_TINH AS LUONG_TINH_CO, TKDMCO.SO_DU AS SO_DU_GOC_CO, NVKTCO.SO_TIEN AS SO_TIEN_CO, NVKTCO.LY_DO AS LY_DO_CO, NT.TEN_NT \
	FROM CHUNG_TU AS CT, \
				CHUNG_TU_NVKT AS CTNVKTNO, \
				NGHIEP_VU_KE_TOAN AS NVKTNO \
					LEFT JOIN ( \
						SELECT EM_NO.EMPLOYEE_ID AS MA_DT, 1 AS LOAI_DT, NULL AS KH_DT, EM_NO.FULL_NAME COLLATE utf8_general_ci AS TEN_DT , NULL AS MA_THUE, EM_NO.DEPARTMENT COLLATE utf8_general_ci AS DIA_CHI FROM EMPLOYEE_INFO AS EM_NO \
						UNION SELECT KH_NO.MA_KH AS MA_DT, 4 AS LOAI_DT, KH_NO.KH_KH AS KH_DT, KH_NO.TEN_KH AS TEN_DT, KH_NO.MA_THUE, KH_NO.DIA_CHI FROM KHACH_HANG AS KH_NO \
						UNION SELECT NCC_NO.MA_NCC AS MA_DT, 3 AS LOAI_DT, NCC_NO.KH_NCC AS KH_DT, NCC_NO.TEN_NCC AS TEN_DT, NCC_NO.MA_THUE, NCC_NO.DIA_CHI FROM NHA_CUNG_CAP AS NCC_NO) AS CT_DT_NO \
					ON NVKTNO.MA_DT=CT_DT_NO.MA_DT AND NVKTNO.LOAI_DT=CT_DT_NO.LOAI_DT, \
				CHUNG_TU_NVKT AS CTNVKTCO, \
				NGHIEP_VU_KE_TOAN AS NVKTCO \
					LEFT JOIN ( \
						SELECT EM_CO.EMPLOYEE_ID AS MA_DT, 1 AS LOAI_DT, NULL AS KH_DT, EM_CO.FULL_NAME COLLATE utf8_general_ci AS TEN_DT , NULL AS MA_THUE, EM_CO.DEPARTMENT COLLATE utf8_general_ci AS DIA_CHI FROM EMPLOYEE_INFO AS EM_CO \
						UNION SELECT KH_CO.MA_KH AS MA_DT, 4 AS LOAI_DT, KH_CO.KH_KH AS KH_DT, KH_CO.TEN_KH AS TEN_DT, KH_CO.MA_THUE, KH_CO.DIA_CHI FROM KHACH_HANG AS KH_CO \
						UNION SELECT NCC_CO.MA_NCC AS MA_DT, 3 AS LOAI_DT, NCC_CO.KH_NCC AS KH_DT, NCC_CO.TEN_NCC AS TEN_DT, NCC_CO.MA_THUE, NCC_CO.DIA_CHI FROM NHA_CUNG_CAP AS NCC_CO) AS CT_DT_CO \
					ON NVKTCO.MA_DT=CT_DT_CO.MA_DT AND NVKTCO.LOAI_DT=CT_DT_CO.LOAI_DT, \
				TAI_KHOAN_DANH_MUC AS TKDMNO, TAI_KHOAN_DANH_MUC AS TKDMCO, NGOAI_TE AS NT \
	WHERE CT.LOAI_CT IN ('KTTH') AND CT.MA_CT=CTNVKTNO.MA_CT AND CT.MA_CT=CTNVKTCO.MA_CT AND NVKTNO.SO_DU=-1 AND NVKTCO.SO_DU=1 AND CTNVKTNO.NHOM_DK=CTNVKTNO.NHOM_DK \
		AND CTNVKTNO.MA_NVKT=NVKTNO.MA_NVKT AND CTNVKTCO.MA_NVKT=NVKTCO.MA_NVKT AND NVKTNO.MA_TK=TKDMNO.MA_TK AND NVKTCO.MA_TK=TKDMCO.MA_TK AND CT.LOAI_TIEN=NT.MA_NT \
		AND (NVKTNO.MA_TK LIKE '$MA_TK$%' OR NVKTCO.MA_TK LIKE '$MA_TK$%') $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$

DANH_SACH_NGHIEP_VU_KE_TOAN_KHO_THEO_DIEU_KIEN=SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.LOAI_TIEN, CT.TY_GIA, CT.KEM_THEO, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, '' AS KH_DT, CT_DT.FULL_NAME COLLATE UTF8_GENERAL_CI AS TEN_DT , '' AS MA_THUE, CT_DT.DEPARTMENT COLLATE UTF8_GENERAL_CI AS DIA_CHI, CTHH.MA_HH, CTHH.DON_GIA, CTHH.SO_LUONG_TN, HHG.MA_GIA, HHG.DON_GIA AS GIA_KHO, CTHH.CHIEU, NVKTNO.MA_NVKT, NVKTNO.MA_TK AS MA_TK_NO, TKDMNO.TEN_TK AS TEN_TK_NO, TKDMNO.LUONG_TINH AS LUONG_TINH_NO, TKDMNO.SO_DU AS SO_DU_GOC_NO, NVKTNO.SO_TIEN AS SO_TIEN_NO, NVKTNO.LY_DO AS LY_DO_NO, NVKTCO.MA_NVKT, NVKTCO.MA_TK AS MA_TK_CO, TKDMCO.TEN_TK AS TEN_TK_CO, TKDMCO.LUONG_TINH AS LUONG_TINH_CO, TKDMCO.SO_DU AS SO_DU_GOC_CO, NVKTCO.SO_TIEN AS SO_TIEN_CO, NVKTCO.LY_DO AS LY_DO_CO, NT.TEN_NT \
		FROM CHUNG_TU AS CT, CHUNG_TU_HANG_HOA AS CTHH, HANG_HOA_GIA AS HHG, CHUNG_TU_NVKT AS CTNVKTNO, NGHIEP_VU_KE_TOAN AS NVKTNO, CHUNG_TU_NVKT AS CTNVKTCO, NGHIEP_VU_KE_TOAN AS NVKTCO, EMPLOYEE_INFO AS CT_DT, TAI_KHOAN_DANH_MUC AS TKDMNO, TAI_KHOAN_DANH_MUC AS TKDMCO, NGOAI_TE AS NT \
		WHERE CT.LOAI_CT IN ('MH','BH') AND CT.MA_CT=CTHH.MA_CT AND CTHH.MA_GIA_KHO=HHG.MA_GIA AND CT.MA_CT=CTNVKTNO.MA_CT AND CT.MA_CT=CTNVKTCO.MA_CT AND CTHH.MA_HH=CTNVKTNO.MA_HH AND CTHH.MA_HH=CTNVKTCO.MA_HH AND NVKTNO.SO_DU=-1 AND NVKTCO.SO_DU=1 AND CTNVKTNO.MA_NVKT=NVKTNO.MA_NVKT AND CTNVKTCO.MA_NVKT=NVKTCO.MA_NVKT AND CTNVKTNO.NHOM_DK=CTNVKTCO.NHOM_DK AND CT.MA_DT=CT_DT.EMPLOYEE_ID AND NVKTNO.MA_TK=TKDMNO.MA_TK AND NVKTCO.MA_TK=TKDMCO.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND CT.LOAI_DT=1 AND (NVKTNO.MA_TK LIKE '$MA_TK$%' OR NVKTCO.MA_TK LIKE '$MA_TK$%') $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$ \
	UNION \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.LOAI_TIEN, CT.TY_GIA, CT.KEM_THEO, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, CT_DT.KH_KH AS KH_DT, CT_DT.TEN_KH AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, CTHH.MA_HH, CTHH.DON_GIA, CTHH.SO_LUONG_TN, HHG.MA_GIA, HHG.DON_GIA AS GIA_KHO, CTHH.CHIEU, NVKTNO.MA_NVKT, NVKTNO.MA_TK AS MA_TK_NO, TKDMNO.TEN_TK AS TEN_TK_NO, TKDMNO.LUONG_TINH AS LUONG_TINH_NO, TKDMNO.SO_DU AS SO_DU_GOC_NO, NVKTNO.SO_TIEN AS SO_TIEN_NO, NVKTNO.LY_DO AS LY_DO_NO, CTNVKTCO.MA_NVKT, NVKTCO.MA_TK AS MA_TK_CO, TKDMCO.TEN_TK AS TEN_TK_CO, TKDMCO.LUONG_TINH AS LUONG_TINH_CO, TKDMCO.SO_DU AS SO_DU_GOC_CO, NVKTCO.SO_TIEN AS SO_TIEN_CO, NVKTCO.LY_DO AS LY_DO_CO, NT.TEN_NT \
		FROM CHUNG_TU AS CT, CHUNG_TU_HANG_HOA AS CTHH, HANG_HOA_GIA AS HHG, CHUNG_TU_NVKT AS CTNVKTNO, NGHIEP_VU_KE_TOAN AS NVKTNO, CHUNG_TU_NVKT AS CTNVKTCO, NGHIEP_VU_KE_TOAN AS NVKTCO, KHACH_HANG AS CT_DT, TAI_KHOAN_DANH_MUC AS TKDMNO, TAI_KHOAN_DANH_MUC AS TKDMCO, NGOAI_TE AS NT \
		WHERE CT.LOAI_CT IN ('MH','BH') AND CT.MA_CT=CTHH.MA_CT AND CTHH.MA_GIA_KHO=HHG.MA_GIA AND CT.MA_CT=CTNVKTNO.MA_CT AND CT.MA_CT=CTNVKTCO.MA_CT AND CTHH.MA_HH=CTNVKTNO.MA_HH AND CTHH.MA_HH=CTNVKTCO.MA_HH AND NVKTNO.SO_DU=-1 AND NVKTCO.SO_DU=1 AND CTNVKTNO.MA_NVKT=NVKTNO.MA_NVKT AND CTNVKTCO.MA_NVKT=NVKTCO.MA_NVKT AND CTNVKTNO.NHOM_DK=CTNVKTCO.NHOM_DK AND CT.MA_DT=CT_DT.MA_KH AND NVKTNO.MA_TK=TKDMNO.MA_TK AND NVKTCO.MA_TK=TKDMCO.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND CT.LOAI_DT IN (2, 4) AND (NVKTNO.MA_TK LIKE '$MA_TK$%' OR NVKTCO.MA_TK LIKE '$MA_TK$%') $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$ \
	UNION \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.LOAI_TIEN, CT.TY_GIA, CT.KEM_THEO, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, CT_DT.KH_NCC AS KH_DT, CT_DT.TEN_NCC AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, CTHH.MA_HH, CTHH.DON_GIA, CTHH.SO_LUONG_TN, HHG.MA_GIA, HHG.DON_GIA AS GIA_KHO, CTHH.CHIEU, NVKTNO.MA_NVKT, NVKTNO.MA_TK AS MA_TK_NO, TKDMNO.TEN_TK AS TEN_TK_NO, TKDMNO.LUONG_TINH AS LUONG_TINH_NO, TKDMNO.SO_DU AS SO_DU_GOC_NO, NVKTNO.SO_TIEN AS SO_TIEN_NO, NVKTNO.LY_DO AS LY_DO_NO, CTNVKTCO.MA_NVKT, NVKTCO.MA_TK AS MA_TK_CO, TKDMCO.TEN_TK AS TEN_TK_CO, TKDMCO.LUONG_TINH AS LUONG_TINH_CO, TKDMCO.SO_DU AS SO_DU_GOC_CO, NVKTCO.SO_TIEN AS SO_TIEN_CO, NVKTCO.LY_DO AS LY_DO_CO, NT.TEN_NT \
		FROM CHUNG_TU AS CT, CHUNG_TU_HANG_HOA AS CTHH, HANG_HOA_GIA AS HHG, CHUNG_TU_NVKT AS CTNVKTNO, NGHIEP_VU_KE_TOAN AS NVKTNO, CHUNG_TU_NVKT AS CTNVKTCO, NGHIEP_VU_KE_TOAN AS NVKTCO, NHA_CUNG_CAP AS CT_DT, TAI_KHOAN_DANH_MUC AS TKDMNO, TAI_KHOAN_DANH_MUC AS TKDMCO, NGOAI_TE AS NT \
		WHERE CT.LOAI_CT IN ('MH','BH') AND CT.MA_CT=CTHH.MA_CT AND CTHH.MA_GIA_KHO=HHG.MA_GIA AND CT.MA_CT=CTNVKTNO.MA_CT AND CT.MA_CT=CTNVKTCO.MA_CT AND CTHH.MA_HH=CTNVKTNO.MA_HH AND CTHH.MA_HH=CTNVKTCO.MA_HH AND NVKTNO.SO_DU=-1 AND NVKTCO.SO_DU=1 AND CTNVKTNO.MA_NVKT=NVKTNO.MA_NVKT AND CTNVKTCO.MA_NVKT=NVKTCO.MA_NVKT AND CTNVKTNO.NHOM_DK=CTNVKTCO.NHOM_DK AND CT.MA_DT=CT_DT.MA_NCC AND NVKTNO.MA_TK=TKDMNO.MA_TK AND NVKTCO.MA_TK=TKDMCO.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND CT.LOAI_DT=3 AND (NVKTNO.MA_TK LIKE '$MA_TK$%' OR NVKTCO.MA_TK LIKE '$MA_TK$%') $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$ \
	ORDER BY NGAY_HT DESC, MA_CT DESC

DANH_SACH_NGHIEP_VU_KE_TOAN_KHO_THEO_MA_HH=SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.LOAI_TIEN, CT.TY_GIA, CT.KEM_THEO, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, '' AS KH_DT, CT_DT.FULL_NAME COLLATE UTF8_GENERAL_CI AS TEN_DT , '' AS MA_THUE, CT_DT.DEPARTMENT COLLATE UTF8_GENERAL_CI AS DIA_CHI, CTHH.MA_HH, CTHH.DON_GIA, CTHH.SO_LUONG_TN, HHG.MA_GIA, HHG.DON_GIA AS GIA_KHO, CTHH.CHIEU, NVKTNO.MA_NVKT, NVKTNO.MA_TK AS MA_TK_NO, TKDMNO.TEN_TK AS TEN_TK_NO, TKDMNO.LUONG_TINH AS LUONG_TINH_NO, TKDMNO.SO_DU AS SO_DU_GOC_NO, NVKTNO.SO_TIEN AS SO_TIEN_NO, NVKTNO.LY_DO AS LY_DO_NO, NVKTCO.MA_NVKT, NVKTCO.MA_TK AS MA_TK_CO, TKDMCO.TEN_TK AS TEN_TK_CO, TKDMCO.LUONG_TINH AS LUONG_TINH_CO, TKDMCO.SO_DU AS SO_DU_GOC_CO, NVKTCO.SO_TIEN AS SO_TIEN_CO, NVKTCO.LY_DO AS LY_DO_CO, NT.TEN_NT \
		FROM CHUNG_TU AS CT, CHUNG_TU_HANG_HOA AS CTHH, HANG_HOA_GIA AS HHG, CHUNG_TU_NVKT AS CTNVKTNO, NGHIEP_VU_KE_TOAN AS NVKTNO, CHUNG_TU_NVKT AS CTNVKTCO, NGHIEP_VU_KE_TOAN AS NVKTCO, EMPLOYEE_INFO AS CT_DT, TAI_KHOAN_DANH_MUC AS TKDMNO, TAI_KHOAN_DANH_MUC AS TKDMCO, NGOAI_TE AS NT \
		WHERE CT.LOAI_CT IN ('MH','BH') AND CT.MA_CT=CTHH.MA_CT AND CTHH.MA_GIA_KHO=HHG.MA_GIA AND CT.MA_CT=CTNVKTNO.MA_CT AND CT.MA_CT=CTNVKTCO.MA_CT AND CTHH.MA_HH=CTNVKTNO.MA_HH AND CTHH.MA_HH=CTNVKTCO.MA_HH AND NVKTNO.SO_DU=-1 AND NVKTCO.SO_DU=1 AND CTNVKTNO.MA_NVKT=NVKTNO.MA_NVKT AND CTNVKTCO.MA_NVKT=NVKTCO.MA_NVKT AND CTNVKTNO.NHOM_DK=CTNVKTCO.NHOM_DK AND CT.MA_DT=CT_DT.EMPLOYEE_ID AND NVKTNO.MA_TK=TKDMNO.MA_TK AND NVKTCO.MA_TK=TKDMCO.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND CT.LOAI_DT=1 AND (NVKTNO.MA_TK LIKE '$MA_TK$%' OR NVKTCO.MA_TK LIKE '$MA_TK$%') AND CTHH.MA_HH=? $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$ \
	UNION \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.LOAI_TIEN, CT.TY_GIA, CT.KEM_THEO, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, CT_DT.KH_KH AS KH_DT, CT_DT.TEN_KH AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, CTHH.MA_HH, CTHH.DON_GIA, CTHH.SO_LUONG_TN, HHG.MA_GIA, HHG.DON_GIA AS GIA_KHO, CTHH.CHIEU, NVKTNO.MA_NVKT, NVKTNO.MA_TK AS MA_TK_NO, TKDMNO.TEN_TK AS TEN_TK_NO, TKDMNO.LUONG_TINH AS LUONG_TINH_NO, TKDMNO.SO_DU AS SO_DU_GOC_NO, NVKTNO.SO_TIEN AS SO_TIEN_NO, NVKTNO.LY_DO AS LY_DO_NO, CTNVKTCO.MA_NVKT, NVKTCO.MA_TK AS MA_TK_CO, TKDMCO.TEN_TK AS TEN_TK_CO, TKDMCO.LUONG_TINH AS LUONG_TINH_CO, TKDMCO.SO_DU AS SO_DU_GOC_CO, NVKTCO.SO_TIEN AS SO_TIEN_CO, NVKTCO.LY_DO AS LY_DO_CO, NT.TEN_NT \
		FROM CHUNG_TU AS CT, CHUNG_TU_HANG_HOA AS CTHH, HANG_HOA_GIA AS HHG, CHUNG_TU_NVKT AS CTNVKTNO, NGHIEP_VU_KE_TOAN AS NVKTNO, CHUNG_TU_NVKT AS CTNVKTCO, NGHIEP_VU_KE_TOAN AS NVKTCO, KHACH_HANG AS CT_DT, TAI_KHOAN_DANH_MUC AS TKDMNO, TAI_KHOAN_DANH_MUC AS TKDMCO, NGOAI_TE AS NT \
		WHERE CT.LOAI_CT IN ('MH','BH') AND CT.MA_CT=CTHH.MA_CT AND CTHH.MA_GIA_KHO=HHG.MA_GIA AND CT.MA_CT=CTNVKTNO.MA_CT AND CT.MA_CT=CTNVKTCO.MA_CT AND CTHH.MA_HH=CTNVKTNO.MA_HH AND CTHH.MA_HH=CTNVKTCO.MA_HH AND NVKTNO.SO_DU=-1 AND NVKTCO.SO_DU=1 AND CTNVKTNO.MA_NVKT=NVKTNO.MA_NVKT AND CTNVKTCO.MA_NVKT=NVKTCO.MA_NVKT AND CTNVKTNO.NHOM_DK=CTNVKTCO.NHOM_DK AND CT.MA_DT=CT_DT.MA_KH AND NVKTNO.MA_TK=TKDMNO.MA_TK AND NVKTCO.MA_TK=TKDMCO.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND CT.LOAI_DT IN (2, 4) AND (NVKTNO.MA_TK LIKE '$MA_TK$%' OR NVKTCO.MA_TK LIKE '$MA_TK$%') AND CTHH.MA_HH=? $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$ \
	UNION \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.LOAI_TIEN, CT.TY_GIA, CT.KEM_THEO, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, CT_DT.KH_NCC AS KH_DT, CT_DT.TEN_NCC AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, CTHH.MA_HH, CTHH.DON_GIA, CTHH.SO_LUONG_TN, HHG.MA_GIA, HHG.DON_GIA AS GIA_KHO, CTHH.CHIEU, NVKTNO.MA_NVKT, NVKTNO.MA_TK AS MA_TK_NO, TKDMNO.TEN_TK AS TEN_TK_NO, TKDMNO.LUONG_TINH AS LUONG_TINH_NO, TKDMNO.SO_DU AS SO_DU_GOC_NO, NVKTNO.SO_TIEN AS SO_TIEN_NO, NVKTNO.LY_DO AS LY_DO_NO, CTNVKTCO.MA_NVKT, NVKTCO.MA_TK AS MA_TK_CO, TKDMCO.TEN_TK AS TEN_TK_CO, TKDMCO.LUONG_TINH AS LUONG_TINH_CO, TKDMCO.SO_DU AS SO_DU_GOC_CO, NVKTCO.SO_TIEN AS SO_TIEN_CO, NVKTCO.LY_DO AS LY_DO_CO, NT.TEN_NT \
		FROM CHUNG_TU AS CT, CHUNG_TU_HANG_HOA AS CTHH, HANG_HOA_GIA AS HHG, CHUNG_TU_NVKT AS CTNVKTNO, NGHIEP_VU_KE_TOAN AS NVKTNO, CHUNG_TU_NVKT AS CTNVKTCO, NGHIEP_VU_KE_TOAN AS NVKTCO, NHA_CUNG_CAP AS CT_DT, TAI_KHOAN_DANH_MUC AS TKDMNO, TAI_KHOAN_DANH_MUC AS TKDMCO, NGOAI_TE AS NT \
		WHERE CT.LOAI_CT IN ('MH','BH') AND CT.MA_CT=CTHH.MA_CT AND CTHH.MA_GIA_KHO=HHG.MA_GIA AND CT.MA_CT=CTNVKTNO.MA_CT AND CT.MA_CT=CTNVKTCO.MA_CT AND CTHH.MA_HH=CTNVKTNO.MA_HH AND CTHH.MA_HH=CTNVKTCO.MA_HH AND NVKTNO.SO_DU=-1 AND NVKTCO.SO_DU=1 AND CTNVKTNO.MA_NVKT=NVKTNO.MA_NVKT AND CTNVKTCO.MA_NVKT=NVKTCO.MA_NVKT AND CTNVKTNO.NHOM_DK=CTNVKTCO.NHOM_DK AND CT.MA_DT=CT_DT.MA_NCC AND NVKTNO.MA_TK=TKDMNO.MA_TK AND NVKTCO.MA_TK=TKDMCO.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND CT.LOAI_DT=3 AND (NVKTNO.MA_TK LIKE '$MA_TK$%' OR NVKTCO.MA_TK LIKE '$MA_TK$%') AND CTHH.MA_HH=? $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$ \
	ORDER BY NGAY_HT DESC, MA_CT DESC

DANH_SACH_NGHIEP_VU_KE_TOAN_KHO_THEO_MA_HH_MA_KHOS=SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.LOAI_TIEN, CT.TY_GIA, CT.KEM_THEO, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, '' AS KH_DT, CT_DT.FULL_NAME COLLATE UTF8_GENERAL_CI AS TEN_DT , '' AS MA_THUE, CT_DT.DEPARTMENT COLLATE UTF8_GENERAL_CI AS DIA_CHI, CTHH.MA_HH, CTHH.DON_GIA, CTHH.SO_LUONG_TN, HHG.MA_GIA, HHG.DON_GIA AS GIA_KHO, CTHH.CHIEU, NVKTNO.MA_NVKT, NVKTNO.MA_TK AS MA_TK_NO, TKDMNO.TEN_TK AS TEN_TK_NO, TKDMNO.LUONG_TINH AS LUONG_TINH_NO, TKDMNO.SO_DU AS SO_DU_GOC_NO, NVKTNO.SO_TIEN AS SO_TIEN_NO, NVKTNO.LY_DO AS LY_DO_NO, NVKTCO.MA_NVKT, NVKTCO.MA_TK AS MA_TK_CO, TKDMCO.TEN_TK AS TEN_TK_CO, TKDMCO.LUONG_TINH AS LUONG_TINH_CO, TKDMCO.SO_DU AS SO_DU_GOC_CO, NVKTCO.SO_TIEN AS SO_TIEN_CO, NVKTCO.LY_DO AS LY_DO_CO, NT.TEN_NT \
		FROM CHUNG_TU AS CT, CHUNG_TU_HANG_HOA AS CTHH, HANG_HOA_GIA AS HHG, CHUNG_TU_NVKT AS CTNVKTNO, NGHIEP_VU_KE_TOAN AS NVKTNO, CHUNG_TU_NVKT AS CTNVKTCO, NGHIEP_VU_KE_TOAN AS NVKTCO, EMPLOYEE_INFO AS CT_DT, TAI_KHOAN_DANH_MUC AS TKDMNO, TAI_KHOAN_DANH_MUC AS TKDMCO, NGOAI_TE AS NT \
		WHERE CT.LOAI_CT IN ('MH','BH') AND CT.MA_CT=CTHH.MA_CT AND CTHH.MA_GIA_KHO=HHG.MA_GIA AND CT.MA_CT=CTNVKTNO.MA_CT AND CT.MA_CT=CTNVKTCO.MA_CT AND CTHH.MA_HH=CTNVKTNO.MA_HH AND CTHH.MA_HH=CTNVKTCO.MA_HH AND NVKTNO.SO_DU=-1 AND NVKTCO.SO_DU=1 AND CTNVKTNO.MA_NVKT=NVKTNO.MA_NVKT AND CTNVKTCO.MA_NVKT=NVKTCO.MA_NVKT AND CTNVKTNO.NHOM_DK=CTNVKTCO.NHOM_DK AND CT.MA_DT=CT_DT.EMPLOYEE_ID AND NVKTNO.MA_TK=TKDMNO.MA_TK AND NVKTCO.MA_TK=TKDMCO.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND CT.LOAI_DT=1 AND (NVKTNO.MA_TK LIKE '$MA_TK$%' OR NVKTCO.MA_TK LIKE '$MA_TK$%') AND CTHH.MA_HH=? $DIEU_KIEN_MA_KHO$ $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$ \
	UNION \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.LOAI_TIEN, CT.TY_GIA, CT.KEM_THEO, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, CT_DT.KH_KH AS KH_DT, CT_DT.TEN_KH AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, CTHH.MA_HH, CTHH.DON_GIA, CTHH.SO_LUONG_TN, HHG.MA_GIA, HHG.DON_GIA AS GIA_KHO, CTHH.CHIEU, NVKTNO.MA_NVKT, NVKTNO.MA_TK AS MA_TK_NO, TKDMNO.TEN_TK AS TEN_TK_NO, TKDMNO.LUONG_TINH AS LUONG_TINH_NO, TKDMNO.SO_DU AS SO_DU_GOC_NO, NVKTNO.SO_TIEN AS SO_TIEN_NO, NVKTNO.LY_DO AS LY_DO_NO, CTNVKTCO.MA_NVKT, NVKTCO.MA_TK AS MA_TK_CO, TKDMCO.TEN_TK AS TEN_TK_CO, TKDMCO.LUONG_TINH AS LUONG_TINH_CO, TKDMCO.SO_DU AS SO_DU_GOC_CO, NVKTCO.SO_TIEN AS SO_TIEN_CO, NVKTCO.LY_DO AS LY_DO_CO, NT.TEN_NT \
		FROM CHUNG_TU AS CT, CHUNG_TU_HANG_HOA AS CTHH, HANG_HOA_GIA AS HHG, CHUNG_TU_NVKT AS CTNVKTNO, NGHIEP_VU_KE_TOAN AS NVKTNO, CHUNG_TU_NVKT AS CTNVKTCO, NGHIEP_VU_KE_TOAN AS NVKTCO, KHACH_HANG AS CT_DT, TAI_KHOAN_DANH_MUC AS TKDMNO, TAI_KHOAN_DANH_MUC AS TKDMCO, NGOAI_TE AS NT \
		WHERE CT.LOAI_CT IN ('MH','BH') AND CT.MA_CT=CTHH.MA_CT AND CTHH.MA_GIA_KHO=HHG.MA_GIA AND CT.MA_CT=CTNVKTNO.MA_CT AND CT.MA_CT=CTNVKTCO.MA_CT AND CTHH.MA_HH=CTNVKTNO.MA_HH AND CTHH.MA_HH=CTNVKTCO.MA_HH AND NVKTNO.SO_DU=-1 AND NVKTCO.SO_DU=1 AND CTNVKTNO.MA_NVKT=NVKTNO.MA_NVKT AND CTNVKTCO.MA_NVKT=NVKTCO.MA_NVKT AND CTNVKTNO.NHOM_DK=CTNVKTCO.NHOM_DK AND CT.MA_DT=CT_DT.MA_KH AND NVKTNO.MA_TK=TKDMNO.MA_TK AND NVKTCO.MA_TK=TKDMCO.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND CT.LOAI_DT IN (2, 4) AND (NVKTNO.MA_TK LIKE '$MA_TK$%' OR NVKTCO.MA_TK LIKE '$MA_TK$%') AND CTHH.MA_HH=? $DIEU_KIEN_MA_KHO$ $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$ \
	UNION \
	SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.LOAI_TIEN, CT.TY_GIA, CT.KEM_THEO, CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, CT_DT.KH_NCC AS KH_DT, CT_DT.TEN_NCC AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, CTHH.MA_HH, CTHH.DON_GIA, CTHH.SO_LUONG_TN, HHG.MA_GIA, HHG.DON_GIA AS GIA_KHO, CTHH.CHIEU, NVKTNO.MA_NVKT, NVKTNO.MA_TK AS MA_TK_NO, TKDMNO.TEN_TK AS TEN_TK_NO, TKDMNO.LUONG_TINH AS LUONG_TINH_NO, TKDMNO.SO_DU AS SO_DU_GOC_NO, NVKTNO.SO_TIEN AS SO_TIEN_NO, NVKTNO.LY_DO AS LY_DO_NO, CTNVKTCO.MA_NVKT, NVKTCO.MA_TK AS MA_TK_CO, TKDMCO.TEN_TK AS TEN_TK_CO, TKDMCO.LUONG_TINH AS LUONG_TINH_CO, TKDMCO.SO_DU AS SO_DU_GOC_CO, NVKTCO.SO_TIEN AS SO_TIEN_CO, NVKTCO.LY_DO AS LY_DO_CO, NT.TEN_NT \
		FROM CHUNG_TU AS CT, CHUNG_TU_HANG_HOA AS CTHH, HANG_HOA_GIA AS HHG, CHUNG_TU_NVKT AS CTNVKTNO, NGHIEP_VU_KE_TOAN AS NVKTNO, CHUNG_TU_NVKT AS CTNVKTCO, NGHIEP_VU_KE_TOAN AS NVKTCO, NHA_CUNG_CAP AS CT_DT, TAI_KHOAN_DANH_MUC AS TKDMNO, TAI_KHOAN_DANH_MUC AS TKDMCO, NGOAI_TE AS NT \
		WHERE CT.LOAI_CT IN ('MH','BH') AND CT.MA_CT=CTHH.MA_CT AND CTHH.MA_GIA_KHO=HHG.MA_GIA AND CT.MA_CT=CTNVKTNO.MA_CT AND CT.MA_CT=CTNVKTCO.MA_CT AND CTHH.MA_HH=CTNVKTNO.MA_HH AND CTHH.MA_HH=CTNVKTCO.MA_HH AND NVKTNO.SO_DU=-1 AND NVKTCO.SO_DU=1 AND CTNVKTNO.MA_NVKT=NVKTNO.MA_NVKT AND CTNVKTCO.MA_NVKT=NVKTCO.MA_NVKT AND CTNVKTNO.NHOM_DK=CTNVKTCO.NHOM_DK AND CT.MA_DT=CT_DT.MA_NCC AND NVKTNO.MA_TK=TKDMNO.MA_TK AND NVKTCO.MA_TK=TKDMCO.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND CT.LOAI_DT=3 AND (NVKTNO.MA_TK LIKE '$MA_TK$%' OR NVKTCO.MA_TK LIKE '$MA_TK$%') AND CTHH.MA_HH=? $DIEU_KIEN_MA_KHO$ $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$ \
	ORDER BY NGAY_HT DESC, MA_CT DESC

DANH_SACH_NGHIEP_VU_KE_TOAN_KC_THEO_DIEU_KIEN=SELECT CT.MA_CT, CT.SO_CT, CT.LOAI_CT, CT.TINH_CHAT, CT.NGAY_LAP, CT.NGAY_HT, CT.NGAY_TT, CT.LY_DO, CT.LOAI_TIEN, CT.TY_GIA, CT.KEM_THEO, BTKC.MA_KC, NVKTNO.MA_NVKT, NVKTNO.MA_TK AS MA_TK_NO, TKDMNO.TEN_TK AS TEN_TK_NO, TKDMNO.LUONG_TINH AS LUONG_TINH_NO, TKDMNO.SO_DU AS SO_DU_GOC_NO, NVKTNO.SO_TIEN AS SO_TIEN_NO, NVKTNO.LY_DO AS LY_DO_NO, NVKTCO.MA_NVKT, NVKTCO.MA_TK AS MA_TK_CO, TKDMCO.TEN_TK AS TEN_TK_CO, TKDMCO.LUONG_TINH AS LUONG_TINH_CO, TKDMCO.SO_DU AS SO_DU_GOC_CO, NVKTCO.SO_TIEN AS SO_TIEN_CO, NVKTCO.LY_DO AS LY_DO_CO, NT.TEN_NT \
		FROM CHUNG_TU AS CT, BUT_TOAN_KET_CHUYEN AS BTKC, CHUNG_TU_NVKT AS CTNVKTNO, NGHIEP_VU_KE_TOAN AS NVKTNO, CHUNG_TU_NVKT AS CTNVKTCO, NGHIEP_VU_KE_TOAN AS NVKTCO, TAI_KHOAN_DANH_MUC AS TKDMNO, TAI_KHOAN_DANH_MUC AS TKDMCO, NGOAI_TE AS NT \
		WHERE CT.MA_CT=CTNVKTNO.MA_CT AND CT.MA_CT=CTNVKTCO.MA_CT AND CTNVKTNO.MA_KC=BTKC.MA_KC AND CTNVKTCO.MA_KC=BTKC.MA_KC AND NVKTNO.SO_DU=-1 AND NVKTCO.SO_DU=1 AND CTNVKTNO.MA_NVKT=NVKTNO.MA_NVKT AND CTNVKTCO.MA_NVKT=NVKTCO.MA_NVKT AND NVKTNO.MA_TK=TKDMNO.MA_TK AND NVKTCO.MA_TK=TKDMCO.MA_TK AND CT.LOAI_TIEN=NT.MA_NT AND (NVKTNO.MA_TK LIKE '$MA_TK$%' OR NVKTCO.MA_TK LIKE '$MA_TK$%') $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$ \
	ORDER BY NGAY_HT DESC, MA_CT DESC, THU_TU

TONG_PHAT_SINH=SELECT SUM(NVKT.SO_TIEN) FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT \
	WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK LIKE '$MA_TK$%' AND NVKT.SO_DU=? $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$ GROUP BY NVKT.SO_DU
TONG_PHAT_SINH_DOI_TUONG=SELECT CT.LOAI_DT, CT.MA_DT, NVKT.MA_TK, NVKT.SO_DU, SUM(NVKT.SO_TIEN) SO_TIEN, TKDM.LUONG_TINH FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, TAI_KHOAN_DANH_MUC AS TKDM WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND NVKT.MA_TK LIKE '$MA_TK$%' $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$ GROUP BY CT.LOAI_DT, CT.MA_DT, NVKT.MA_TK, NVKT.SO_DU
TONG_PHAT_SINH_DOI_TUONG_KTTH=SELECT CT_DT.LOAI_DT, CT_DT.MA_DT, NVKT.MA_TK, NVKT.SO_DU, SUM(NVKT.SO_TIEN) SO_TIEN, TKDM.LUONG_TINH \
	FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, TAI_KHOAN_DANH_MUC AS TKDM, NGHIEP_VU_KE_TOAN AS NVKT \
			LEFT JOIN (SELECT EM.EMPLOYEE_ID AS MA_DT, 1 AS LOAI_DT, NULL AS KH_DT, EM.FULL_NAME COLLATE utf8_general_ci AS TEN_DT , NULL AS MA_THUE, EM.DEPARTMENT COLLATE utf8_general_ci AS DIA_CHI FROM EMPLOYEE_INFO AS EM \
				UNION SELECT KH.MA_KH AS MA_DT, 2 AS LOAI_DT, KH.KH_KH AS KH_DT, KH.TEN_KH AS TEN_DT, KH.MA_THUE, KH.DIA_CHI FROM KHACH_HANG AS KH \
				UNION SELECT NCC.MA_NCC AS MA_DT, 3 AS LOAI_DT, NCC.KH_NCC AS KH_DT, NCC.TEN_NCC AS TEN_DT, NCC.MA_THUE, NCC.DIA_CHI FROM NHA_CUNG_CAP AS NCC ) AS CT_DT \
			ON NVKT.MA_DT=CT_DT.MA_DT AND NVKT.LOAI_DT=CT_DT.LOAI_DT \
	WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND NVKT.MA_TK LIKE '$MA_TK$%' $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$ \
	GROUP BY CT_DT.LOAI_DT, CT_DT.MA_DT, NVKT.MA_TK, NVKT.SO_DU
TONG_PHAT_SINH_TOAN_BO=SELECT TKDM.MA_TK, TKDM.TEN_TK, TKDM.LUONG_TINH, TPS.SO_DU, SUM(TPS.SO_TIEN) AS SO_TIEN FROM (SELECT NVKT.MA_TK, NVKT.SO_DU, SUM(NVKT.SO_TIEN) AS SO_TIEN FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$ GROUP BY NVKT.MA_TK, NVKT.SO_DU) AS TPS, TAI_KHOAN_DANH_MUC AS TKDM \
	WHERE LENGTH(TKDM.MA_TK) <= LENGTH(TPS.MA_TK) AND SUBSTR(TPS.MA_TK, 1, LENGTH(TKDM.MA_TK))=TKDM.MA_TK GROUP BY TKDM.MA_TK, TPS.SO_DU ORDER BY TKDM.MA_TK

# Sổ tổng hợp công nợ
DANH_SACH_TONG_HOP_CONG_NO=SELECT DLCN.LOAI_DT, DLCN.MA_DT, DLCN.KH_DT, DLCN.TEN_DT, DLCN.MA_THUE, DLCN.DIA_CHI, DLCN.NGUOI_NOP, DLCN.MA_TK, DLCN.SO_DU, SUM(DLCN.SO_TIEN) AS SO_TIEN, DLCN.LUONG_TINH FROM \
	(SELECT CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, '' AS KH_DT, CT_DT.FULL_NAME COLLATE utf8_general_ci AS TEN_DT , '' AS MA_THUE, CT_DT.DEPARTMENT COLLATE utf8_general_ci AS DIA_CHI, $MA_TK$ AS MA_TK, NVKT.SO_TIEN, NVKT.SO_DU, TKDM.LUONG_TINH \
	FROM CHUNG_TU AS CT, EMPLOYEE_INFO AS CT_DT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, TAI_KHOAN_DANH_MUC AS TKDM \
	WHERE CT.MA_CT=CTNVKT.MA_CT AND CT.MA_DT=CT_DT.EMPLOYEE_ID AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND CT.LOAI_DT=1 AND NVKT.MA_TK LIKE '$MA_TK$%' $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$ \
	UNION \
	SELECT CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, CT_DT.KH_KH AS KH_DT, CT_DT.TEN_KH AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, $MA_TK$ AS MA_TK, NVKT.SO_TIEN, NVKT.SO_DU, TKDM.LUONG_TINH \
	FROM CHUNG_TU AS CT, KHACH_HANG AS CT_DT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, TAI_KHOAN_DANH_MUC AS TKDM \
	WHERE CT.MA_CT=CTNVKT.MA_CT AND CT.MA_DT=CT_DT.MA_KH AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND CT.LOAI_DT IN (2, 4) AND NVKT.MA_TK LIKE '$MA_TK$%' $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$ \
	UNION \
	SELECT CT.MA_DT, CT.LOAI_DT, CT.NGUOI_NOP, CT_DT.KH_NCC AS KH_DT, CT_DT.TEN_NCC AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, $MA_TK$ AS MA_TK, NVKT.SO_TIEN, NVKT.SO_DU, TKDM.LUONG_TINH \
	FROM CHUNG_TU AS CT, NHA_CUNG_CAP AS CT_DT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, TAI_KHOAN_DANH_MUC AS TKDM \
	WHERE CT.MA_CT=CTNVKT.MA_CT AND CT.MA_DT=CT_DT.MA_NCC AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND CT.LOAI_DT=3 AND NVKT.MA_TK LIKE '$MA_TK$%' $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$) AS DLCN \
GROUP BY DLCN.LOAI_DT, DLCN.MA_DT, DLCN.MA_TK, DLCN.SO_DU \
ORDER BY DLCN.LOAI_DT, DLCN.MA_DT, DLCN.MA_TK, DLCN.SO_DU

DANH_SACH_TONG_HOP_CONG_NO_KTTH=SELECT DLCN.LOAI_DT, DLCN.MA_DT, DLCN.KH_DT, DLCN.TEN_DT, DLCN.MA_THUE, DLCN.DIA_CHI, DLCN.NGUOI_NOP, DLCN.MA_TK, DLCN.SO_DU, SUM(DLCN.SO_TIEN) AS SO_TIEN, DLCN.LUONG_TINH FROM \
	(SELECT CT_DT.MA_DT, CT_DT.LOAI_DT, '' AS NGUOI_NOP, CT_DT.KH_DT, CT_DT.TEN_DT , CT_DT.MA_THUE, CT_DT.DIA_CHI, $MA_TK$ AS MA_TK, NVKT.SO_TIEN, NVKT.SO_DU, TKDM.LUONG_TINH \
	FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, TAI_KHOAN_DANH_MUC AS TKDM, NGHIEP_VU_KE_TOAN AS NVKT \
		LEFT JOIN (SELECT EM.EMPLOYEE_ID AS MA_DT, 1 AS LOAI_DT, NULL AS KH_DT, EM.FULL_NAME COLLATE utf8_general_ci AS TEN_DT , NULL AS MA_THUE, EM.DEPARTMENT COLLATE utf8_general_ci AS DIA_CHI FROM EMPLOYEE_INFO AS EM \
			UNION SELECT KH.MA_KH AS MA_DT, 2 AS LOAI_DT, KH.KH_KH AS KH_DT, KH.TEN_KH AS TEN_DT, KH.MA_THUE, KH.DIA_CHI FROM KHACH_HANG AS KH \
			UNION SELECT NCC.MA_NCC AS MA_DT, 3 AS LOAI_DT, NCC.KH_NCC AS KH_DT, NCC.TEN_NCC AS TEN_DT, NCC.MA_THUE, NCC.DIA_CHI FROM NHA_CUNG_CAP AS NCC) AS CT_DT \
		ON NVKT.MA_DT=CT_DT.MA_DT AND NVKT.LOAI_DT=CT_DT.LOAI_DT \
	WHERE CT.LOAI_CT='KTTH' AND CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_TK=TKDM.MA_TK AND NVKT.MA_TK LIKE '$MA_TK$%' $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$) AS DLCN \
GROUP BY DLCN.LOAI_DT, DLCN.MA_DT, DLCN.MA_TK, DLCN.SO_DU \
ORDER BY DLCN.LOAI_DT, DLCN.MA_DT, DLCN.MA_TK, DLCN.SO_DU

# Sổ tổng hợp/chi tiết nhập xuất tồn
# Lưu ý: ở đây đơn vị hàng hóa phải giống nhau, Nếu khác nhau thì phải quy đổi, hiện tại cái này chưa làm
# Ở đây cũng chưa xử lý tình huống một hàng hóa có nhiều giá, nếu vậy phải group by them ma_gia_kho
DANH_SACH_TONG_HOP_NXT=SELECT $MA_TK$ AS MA_TK_GIA_TRI, NVKT.SO_DU AS SO_DU_GIA_TRI, HH.*, HHDV.*, CTHH.CHIEU, SUM(SO_LUONG_TN) AS SO_LUONG, SUM(NVKT.SO_TIEN) AS SO_TIEN \
	FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, CHUNG_TU_HANG_HOA AS CTHH, NGHIEP_VU_KE_TOAN AS NVKT, TAI_KHOAN_DANH_MUC AS TKDM, HANG_HOA_DANH_MUC AS HH, HANG_HOA_DON_VI AS HHDV, HANG_HOA_KHO AS HHK \
	WHERE CT.MA_CT=CTNVKT.MA_CT AND CT.MA_CT=CTHH.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND CTHH.MA_HH=HH.MA_HH AND NVKT.MA_TK=TKDM.MA_TK AND HH.MA_DV=HHDV.MA_DV AND HHK.MA_KHO=CTHH.MA_KHO \
	AND CTNVKT.LOAI_TK=2 AND CT.LOAI_CT IN ('MH', 'BH') $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$ AND NVKT.MA_TK LIKE '$MA_TK$%' $DIEU_KIEN_MA_KHO$ \
	GROUP BY HH.MA_HH, CTHH.CHIEU, MA_TK_GIA_TRI, SO_DU_GIA_TRI
DANH_SACH_TONG_HOP_NXT_MA_HH=SELECT $MA_TK$ AS MA_TK_GIA_TRI, NVKT.SO_DU AS SO_DU_GIA_TRI, HH.*, HHDV.*, CTHH.CHIEU, SUM(SO_LUONG_TN) AS SO_LUONG, SUM(NVKT.SO_TIEN) AS SO_TIEN \
	FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, CHUNG_TU_HANG_HOA AS CTHH, NGHIEP_VU_KE_TOAN AS NVKT, TAI_KHOAN_DANH_MUC AS TKDM, HANG_HOA_DANH_MUC AS HH, HANG_HOA_DON_VI AS HHDV, HANG_HOA_KHO AS HHK \
	WHERE CT.MA_CT=CTNVKT.MA_CT AND CT.MA_CT=CTHH.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND CTHH.MA_HH=HH.MA_HH AND NVKT.MA_TK=TKDM.MA_TK AND HH.MA_DV=HHDV.MA_DV AND HHK.MA_KHO=CTHH.MA_KHO \
	AND CTNVKT.LOAI_TK=2 AND CT.LOAI_CT IN ('MH', 'BH') AND HH.MA_HH=? $DIEU_KIEN_BAT_DAT$ $DIEU_KIEN_KET_THUC$ AND NVKT.MA_TK LIKE '$MA_TK$%' $DIEU_KIEN_MA_KHO$ \
	GROUP BY HH.MA_HH, CTHH.CHIEU, MA_TK_GIA_TRI, SO_DU_GIA_TRI

## CÔNG VIỆC
# Lĩnh vực
DANH_SACH_LINH_VUC=SELECT * FROM LINH_VUC

# Nghiệp vụ
DANH_SACH_NGHIEP_VU=SELECT NV.*, LV.TEN_LV FROM NGHIEP_VU AS NV, LINH_VUC AS LV WHERE NV.MA_LV=LV.MA_LV
DANH_SACH_NGHIEP_VU_THEO_LINH_VUC=SELECT NV.*, LV.TEN_LV FROM NGHIEP_VU AS NV, LINH_VUC AS LV WHERE NV.MA_LV=LV.MA_LV AND LV.MA_LV=?  
LAY_NGHIEP_VU=SELECT NV.*, LV.TEN_LV FROM NGHIEP_VU AS NV, LINH_VUC AS LV WHERE NV.MA_LV=LV.MA_LV AND MA_NV=?
THEM_NGHIEP_VU=INSERT INTO NGHIEP_VU(TEN_NV, MO_TA, MA_LV, DO_KHO) VALUES(?, ?, ?, ?)
CAP_NHAT_NGHIEP_VU=UPDATE NGHIEP_VU SET TEN_NV=?, MO_TA=?, MA_LV=?, DO_KHO=? WHERE MA_NV=?

##KỲ KẾ TOÁN
#Kỳ kế toán
DANH_SACH_KY_KE_TOAN=SELECT * FROM KY_KE_TOAN ORDER BY KET_THUC DESC
LAY_KY_KE_TOAN=SELECT * FROM KY_KE_TOAN WHERE MA_KKT=?
LAY_KY_KE_TOAN_CHUNG_TU=SELECT * FROM KY_KE_TOAN WHERE BAT_DAU<=? AND KET_THUC>=?
LAY_KY_KE_TOAN_MAC_DINH=SELECT * FROM KY_KE_TOAN AS KKT WHERE KKT.MAC_DINH=1
CAP_NHAT_KY_KE_TOAN=UPDATE KY_KE_TOAN SET TEN_KKT=?, BAT_DAU=?, KET_THUC=?, TRANG_THAI=?, MAC_DINH=? WHERE MA_KKT=?
THEM_KY_KE_TOAN=INSERT INTO KY_KE_TOAN (TEN_KKT, BAT_DAU, KET_THUC, TRANG_THAI, MAC_DINH) VALUES(?, ?, ?, ?, ?)
LAY_KET_THUC_CUOI=SELECT MAX(KET_THUC) FROM KY_KE_TOAN
LAY_KET_THUC_CUOI_GIOI_HAN=SELECT MAX(KET_THUC) FROM KY_KE_TOAN WHERE KET_THUC<?
LAY_KY_KE_TOAN_TRUOC=SELECT * FROM KY_KE_TOAN WHERE KET_THUC<? ORDER BY KET_THUC DESC
MAC_DINH_KY_KE_TOAN_TAT_CA=UPDATE KY_KE_TOAN SET MAC_DINH=0
MAC_DINH_KY_KE_TOAN=UPDATE KY_KE_TOAN SET MAC_DINH=1 WHERE MA_KKT=?
DONG_MO_KY_KE_TOAN=UPDATE KY_KE_TOAN SET TRANG_THAI=? WHERE MA_KKT=?
XOA_KY_SO_DU_DAU_KY_KE_TOAN=DELETE FROM KY_KE_TOAN_SO_DU WHERE MA_KKT=?
XOA_KY_KE_TOAN=DELETE FROM KY_KE_TOAN WHERE MA_KKT=?

#Số dư đầu kỳ
LAY_SO_DU_KY_THEO_KKT=SELECT * FROM KY_KE_TOAN_SO_DU AS SD, KY_KE_TOAN AS KKT, TAI_KHOAN_DANH_MUC AS TK, NGOAI_TE AS NT WHERE SD.MA_KKT=KKT.MA_KKT AND SD.MA_TK=TK.MA_TK AND KKT.MA_KKT=? AND MA_DT=0 AND LOAI_DT=0 AND MA_HH=0 AND MA_KHO=0 AND SD.LOAI_TIEN=NT.MA_NT ORDER BY SD.MA_TK
LAY_SO_DU_KY_THEO_KKT_DOI_TUONG=SELECT KKT.*, SD.LOAI_DT, SD.MA_DT, '' AS KH_DT, CT_DT.FULL_NAME COLLATE utf8_general_ci AS TEN_DT, '' AS MA_THUE, CT_DT.DEPARTMENT COLLATE utf8_general_ci AS DIA_CHI, TK.*, SUM(SD.NO_DAU_KY) AS NO_DAU_KY, SUM(SD.NO_DAU_KY_NT) AS NO_DAU_KY_NT, SUM(SD.CO_DAU_KY) AS CO_DAU_KY, SUM(SD.CO_DAU_KY_NT) AS CO_DAU_KY_NT, SUM(SD.NO_CUOI_KY) AS NO_CUOI_KY, SUM(SD.NO_CUOI_KY_NT) AS NO_CUOI_KY_NT, SUM(SD.CO_CUOI_KY) AS CO_CUOI_KY, SUM(SD.CO_CUOI_KY_NT) AS CO_CUOI_KY_NT, NT.MA_NT, NT.TEN_NT \
	FROM KY_KE_TOAN_SO_DU AS SD, KY_KE_TOAN AS KKT, EMPLOYEE_INFO AS CT_DT, TAI_KHOAN_DANH_MUC AS TK, NGOAI_TE AS NT \
	WHERE SD.MA_KKT=KKT.MA_KKT AND SD.MA_TK=TK.MA_TK AND SD.MA_DT=CT_DT.EMPLOYEE_ID AND SD.LOAI_DT IN (1) AND SD.LOAI_DT=? AND KKT.MA_KKT=? AND SD.LOAI_TIEN=NT.MA_NT \
	GROUP BY SD.LOAI_DT, SD.MA_DT, SD.MA_TK \
	UNION \
	SELECT KKT.*, SD.LOAI_DT, SD.MA_DT, CT_DT.KH_KH AS KH_DT, CT_DT.TEN_KH AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, TK.*, SUM(SD.NO_DAU_KY) AS NO_DAU_KY, SUM(SD.NO_DAU_KY_NT) AS NO_DAU_KY_NT, SUM(SD.CO_DAU_KY) AS CO_DAU_KY, SUM(SD.CO_DAU_KY_NT) AS CO_DAU_KY_NT, SUM(SD.NO_CUOI_KY) AS NO_CUOI_KY, SUM(SD.NO_CUOI_KY_NT) AS NO_CUOI_KY_NT, SUM(SD.CO_CUOI_KY) AS CO_CUOI_KY, SUM(SD.CO_CUOI_KY_NT) AS CO_CUOI_KY_NT, NT.MA_NT, NT.TEN_NT \
	FROM KY_KE_TOAN_SO_DU AS SD, KY_KE_TOAN AS KKT, KHACH_HANG AS CT_DT, TAI_KHOAN_DANH_MUC AS TK, NGOAI_TE AS NT \
	WHERE SD.MA_KKT=KKT.MA_KKT AND SD.MA_TK=TK.MA_TK AND SD.MA_DT=CT_DT.MA_KH AND SD.LOAI_DT IN (2, 4) AND SD.LOAI_DT=? AND KKT.MA_KKT=? AND SD.LOAI_TIEN=NT.MA_NT \
	GROUP BY SD.LOAI_DT, SD.MA_DT, SD.MA_TK \
	UNION \
	SELECT KKT.*, SD.LOAI_DT, SD.MA_DT, CT_DT.KH_NCC AS KH_DT, CT_DT.TEN_NCC AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, TK.*, SUM(SD.NO_DAU_KY) AS NO_DAU_KY, SUM(SD.NO_DAU_KY_NT) AS NO_DAU_KY_NT, SUM(SD.CO_DAU_KY) AS CO_DAU_KY, SUM(SD.CO_DAU_KY_NT) AS CO_DAU_KY_NT, SUM(SD.NO_CUOI_KY) AS NO_CUOI_KY, SUM(SD.NO_CUOI_KY_NT) AS NO_CUOI_KY_NT, SUM(SD.CO_CUOI_KY) AS CO_CUOI_KY, SUM(SD.CO_CUOI_KY_NT) AS CO_CUOI_KY_NT, NT.MA_NT, NT.TEN_NT \
	FROM KY_KE_TOAN_SO_DU AS SD, KY_KE_TOAN AS KKT, NHA_CUNG_CAP AS CT_DT, TAI_KHOAN_DANH_MUC AS TK, NGOAI_TE AS NT \
	WHERE SD.MA_KKT=KKT.MA_KKT AND SD.MA_TK=TK.MA_TK AND SD.MA_DT=CT_DT.MA_NCC AND SD.LOAI_DT IN (3) AND SD.LOAI_DT=? AND KKT.MA_KKT=? AND SD.LOAI_TIEN=NT.MA_NT \
	GROUP BY SD.LOAI_DT, SD.MA_DT, SD.MA_TK \
	ORDER BY LOAI_DT, MA_DT, MA_TK
LAY_SO_DU_KY_THEO_KKT_DOI_TUONG_CU_THE=SELECT KKT.*, SD.LOAI_DT, SD.MA_DT, '' AS KH_DT, CT_DT.FULL_NAME COLLATE utf8_general_ci AS TEN_DT, '' AS MA_THUE, CT_DT.DEPARTMENT COLLATE utf8_general_ci AS DIA_CHI, TK.*, SD.NO_DAU_KY, SD.NO_DAU_KY_NT, SD.CO_DAU_KY, SD.CO_DAU_KY_NT, SD.NO_CUOI_KY, SD.NO_CUOI_KY_NT, SD.CO_CUOI_KY, SD.CO_CUOI_KY_NT, NT.MA_NT, NT.TEN_NT \
	FROM KY_KE_TOAN_SO_DU AS SD, KY_KE_TOAN AS KKT, EMPLOYEE_INFO AS CT_DT, TAI_KHOAN_DANH_MUC AS TK, NGOAI_TE AS NT \
	WHERE SD.MA_KKT=KKT.MA_KKT AND SD.MA_TK=TK.MA_TK AND SD.MA_DT=CT_DT.EMPLOYEE_ID AND SD.LOAI_DT IN (1) AND SD.LOAI_DT=? AND SD.MA_DT=? AND SD.MA_TK=? AND KKT.MA_KKT=? AND SD.LOAI_TIEN=NT.MA_NT \
	UNION \
	SELECT KKT.*, SD.LOAI_DT, SD.MA_DT, CT_DT.KH_KH AS KH_DT, CT_DT.TEN_KH AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, TK.*, SD.NO_DAU_KY, SD.NO_DAU_KY_NT, SD.CO_DAU_KY, SD.CO_DAU_KY_NT, SD.NO_CUOI_KY, SD.NO_CUOI_KY_NT, SD.CO_CUOI_KY, SD.CO_CUOI_KY_NT, NT.MA_NT, NT.TEN_NT \
	FROM KY_KE_TOAN_SO_DU AS SD, KY_KE_TOAN AS KKT, KHACH_HANG AS CT_DT, TAI_KHOAN_DANH_MUC AS TK, NGOAI_TE AS NT \
	WHERE SD.MA_KKT=KKT.MA_KKT AND SD.MA_TK=TK.MA_TK AND SD.MA_DT=CT_DT.MA_KH AND SD.LOAI_DT IN (2, 4) AND SD.LOAI_DT=? AND SD.MA_DT=? AND SD.MA_TK=? AND KKT.MA_KKT=? AND SD.LOAI_TIEN=NT.MA_NT \
	UNION \
	SELECT KKT.*, SD.LOAI_DT, SD.MA_DT, CT_DT.KH_NCC AS KH_DT, CT_DT.TEN_NCC AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, TK.*, SD.NO_DAU_KY, SD.NO_DAU_KY_NT, SD.CO_DAU_KY, SD.CO_DAU_KY_NT, SD.NO_CUOI_KY, SD.NO_CUOI_KY_NT, SD.CO_CUOI_KY, SD.CO_CUOI_KY_NT, NT.MA_NT, NT.TEN_NT \
	FROM KY_KE_TOAN_SO_DU AS SD, KY_KE_TOAN AS KKT, NHA_CUNG_CAP AS CT_DT, TAI_KHOAN_DANH_MUC AS TK, NGOAI_TE AS NT \
	WHERE SD.MA_KKT=KKT.MA_KKT AND SD.MA_TK=TK.MA_TK AND SD.MA_DT=CT_DT.MA_NCC AND SD.LOAI_DT IN (3) AND SD.LOAI_DT=? AND SD.MA_DT=? AND SD.MA_TK=? AND KKT.MA_KKT=? AND SD.LOAI_TIEN=NT.MA_NT \
	ORDER BY LOAI_DT, MA_DT, MA_TK
LAY_SO_DU_KY_THEO_KKT_DOI_TUONG_MA_TK=SELECT KKT.*, SD.LOAI_DT, SD.MA_DT, '' AS KH_DT, CT_DT.FULL_NAME COLLATE utf8_general_ci AS TEN_DT, '' AS MA_THUE, CT_DT.DEPARTMENT COLLATE utf8_general_ci AS DIA_CHI, TK.*, SD.NO_DAU_KY, SD.NO_DAU_KY_NT, SD.CO_DAU_KY, SD.CO_DAU_KY_NT, SD.NO_CUOI_KY, SD.NO_CUOI_KY_NT, SD.CO_CUOI_KY, SD.CO_CUOI_KY_NT, NT.MA_NT, NT.TEN_NT \
	FROM KY_KE_TOAN_SO_DU AS SD, KY_KE_TOAN AS KKT, EMPLOYEE_INFO AS CT_DT, TAI_KHOAN_DANH_MUC AS TK, NGOAI_TE AS NT \
	WHERE SD.MA_KKT=KKT.MA_KKT AND SD.MA_TK=TK.MA_TK AND SD.MA_DT=CT_DT.EMPLOYEE_ID AND SD.LOAI_DT IN (1) AND SD.MA_TK=? AND KKT.MA_KKT=? AND SD.LOAI_TIEN=NT.MA_NT \
	UNION \
	SELECT KKT.*, SD.LOAI_DT, SD.MA_DT, CT_DT.KH_KH AS KH_DT, CT_DT.TEN_KH AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, TK.*, SD.NO_DAU_KY, SD.NO_DAU_KY_NT, SD.CO_DAU_KY, SD.CO_DAU_KY_NT, SD.NO_CUOI_KY, SD.NO_CUOI_KY_NT, SD.CO_CUOI_KY, SD.CO_CUOI_KY_NT, NT.MA_NT, NT.TEN_NT \
	FROM KY_KE_TOAN_SO_DU AS SD, KY_KE_TOAN AS KKT, KHACH_HANG AS CT_DT, TAI_KHOAN_DANH_MUC AS TK, NGOAI_TE AS NT \
	WHERE SD.MA_KKT=KKT.MA_KKT AND SD.MA_TK=TK.MA_TK AND SD.MA_DT=CT_DT.MA_KH AND SD.LOAI_DT IN (2, 4) AND SD.MA_TK=? AND KKT.MA_KKT=? AND SD.LOAI_TIEN=NT.MA_NT \
	UNION \
	SELECT KKT.*, SD.LOAI_DT, SD.MA_DT, CT_DT.KH_NCC AS KH_DT, CT_DT.TEN_NCC AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, TK.*, SD.NO_DAU_KY, SD.NO_DAU_KY_NT, SD.CO_DAU_KY, SD.CO_DAU_KY_NT, SD.NO_CUOI_KY, SD.NO_CUOI_KY_NT, SD.CO_CUOI_KY, SD.CO_CUOI_KY_NT, NT.MA_NT, NT.TEN_NT \
	FROM KY_KE_TOAN_SO_DU AS SD, KY_KE_TOAN AS KKT, NHA_CUNG_CAP AS CT_DT, TAI_KHOAN_DANH_MUC AS TK, NGOAI_TE AS NT \
	WHERE SD.MA_KKT=KKT.MA_KKT AND SD.MA_TK=TK.MA_TK AND SD.MA_DT=CT_DT.MA_NCC AND SD.LOAI_DT IN (3) AND SD.MA_TK=? AND KKT.MA_KKT=? AND SD.LOAI_TIEN=NT.MA_NT \
	ORDER BY LOAI_DT, MA_DT, MA_TK
LAY_SO_DU_KY_THEO_KKT_DOI_TUONG_MA_TK_CON=SELECT KKT.*, SD.LOAI_DT, SD.MA_DT, '' AS KH_DT, CT_DT.FULL_NAME COLLATE utf8_general_ci AS TEN_DT, '' AS MA_THUE, CT_DT.DEPARTMENT COLLATE utf8_general_ci AS DIA_CHI, TK.*, SD.NO_DAU_KY, SD.NO_DAU_KY_NT, SD.CO_DAU_KY, SD.CO_DAU_KY_NT, SD.NO_CUOI_KY, SD.NO_CUOI_KY_NT, SD.CO_CUOI_KY, SD.CO_CUOI_KY_NT, NT.MA_NT, NT.TEN_NT \
	FROM KY_KE_TOAN_SO_DU AS SD, KY_KE_TOAN AS KKT, EMPLOYEE_INFO AS CT_DT, TAI_KHOAN_DANH_MUC AS TK, NGOAI_TE AS NT \
	WHERE SD.MA_KKT=KKT.MA_KKT AND SD.MA_TK=TK.MA_TK AND SD.MA_DT=CT_DT.EMPLOYEE_ID AND SD.LOAI_DT IN (1) AND SUBSTRING(?, 1, LENGTH(TK.MA_TK))=TK.MA_TK AND KKT.MA_KKT=? AND SD.LOAI_DT=? AND SD.MA_DT=? AND SD.LOAI_TIEN=NT.MA_NT \
	UNION \
	SELECT KKT.*, SD.LOAI_DT, SD.MA_DT, CT_DT.KH_KH AS KH_DT, CT_DT.TEN_KH AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, TK.*, SD.NO_DAU_KY, SD.NO_DAU_KY_NT, SD.CO_DAU_KY, SD.CO_DAU_KY_NT, SD.NO_CUOI_KY, SD.NO_CUOI_KY_NT, SD.CO_CUOI_KY, SD.CO_CUOI_KY_NT, NT.MA_NT, NT.TEN_NT \
	FROM KY_KE_TOAN_SO_DU AS SD, KY_KE_TOAN AS KKT, KHACH_HANG AS CT_DT, TAI_KHOAN_DANH_MUC AS TK, NGOAI_TE AS NT \
	WHERE SD.MA_KKT=KKT.MA_KKT AND SD.MA_TK=TK.MA_TK AND SD.MA_DT=CT_DT.MA_KH AND SD.LOAI_DT IN (2, 4) AND SUBSTRING(?, 1, LENGTH(TK.MA_TK))=TK.MA_TK AND KKT.MA_KKT=? AND SD.LOAI_DT=? AND SD.MA_DT=? AND SD.LOAI_TIEN=NT.MA_NT \
	UNION \
	SELECT KKT.*, SD.LOAI_DT, SD.MA_DT, CT_DT.KH_NCC AS KH_DT, CT_DT.TEN_NCC AS TEN_DT, CT_DT.MA_THUE, CT_DT.DIA_CHI, TK.*, SD.NO_DAU_KY, SD.NO_DAU_KY_NT, SD.CO_DAU_KY, SD.CO_DAU_KY_NT, SD.NO_CUOI_KY, SD.NO_CUOI_KY_NT, SD.CO_CUOI_KY, SD.CO_CUOI_KY_NT, NT.MA_NT, NT.TEN_NT \
	FROM KY_KE_TOAN_SO_DU AS SD, KY_KE_TOAN AS KKT, NHA_CUNG_CAP AS CT_DT, TAI_KHOAN_DANH_MUC AS TK, NGOAI_TE AS NT \
	WHERE SD.MA_KKT=KKT.MA_KKT AND SD.MA_TK=TK.MA_TK AND SD.MA_DT=CT_DT.MA_NCC AND SD.LOAI_DT IN (3) AND SUBSTRING(?, 1, LENGTH(TK.MA_TK))=TK.MA_TK AND KKT.MA_KKT=? AND SD.LOAI_DT=? AND SD.MA_DT=? AND SD.LOAI_TIEN=NT.MA_NT \
	ORDER BY LOAI_DT, MA_DT, MA_TK
LAY_SO_DU_KY_THEO_HO_TK_KKT=SELECT * FROM KY_KE_TOAN_SO_DU AS SD, KY_KE_TOAN AS KKT, TAI_KHOAN_DANH_MUC AS TK, NGOAI_TE AS NT WHERE SD.MA_KKT=KKT.MA_KKT AND SD.MA_TK=TK.MA_TK AND SUBSTRING(?, 1, LENGTH(TK.MA_TK))=TK.MA_TK AND KKT.MA_KKT=? AND MA_DT=0 AND LOAI_DT=0 AND MA_HH=0 AND MA_KHO=0 AND SD.LOAI_TIEN=NT.MA_NT ORDER BY SD.MA_TK
LAY_SO_DU_KY_THEO_TK_KKT=SELECT * FROM KY_KE_TOAN_SO_DU AS SD, KY_KE_TOAN AS KKT, TAI_KHOAN_DANH_MUC AS TK, NGOAI_TE AS NT WHERE SD.MA_KKT=KKT.MA_KKT AND SD.MA_TK=TK.MA_TK AND SD.MA_TK=? AND KKT.MA_KKT=? AND MA_DT=0 AND LOAI_DT=0 AND MA_HH=0 AND MA_KHO=0 AND SD.LOAI_TIEN=NT.MA_NT ORDER BY SD.MA_TK
TINH_SO_DU_KY_THEO_DOI_TUONG=SELECT CT.MA_DT, CT.LOAI_DT, '' AS KH_DT, CT_DT.FULL_NAME COLLATE utf8_general_ci AS TEN_DT, NVKT.MA_TK, NVKT.SO_DU, SUM(NVKT.SO_TIEN) AS SO_TIEN \
	FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, EMPLOYEE_INFO AS CT_DT \
	WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND CT.MA_DT=CT_DT.EMPLOYEE_ID AND CT.LOAI_DT IN (1) AND NVKT.MA_TK LIKE '$MA_TK$%' AND CT.LOAI_DT IN (?) AND CT.NGAY_HT >= ? AND CT.NGAY_HT <= ? \
	GROUP BY CT.MA_DT, CT.LOAI_DT, NVKT.MA_TK, NVKT.SO_DU \
	UNION \
	SELECT CT.MA_DT, CT.LOAI_DT, CT_DT.KH_KH AS KH_DT, CT_DT.TEN_KH AS TEN_DT, NVKT.MA_TK, NVKT.SO_DU, SUM(NVKT.SO_TIEN) AS SO_TIEN \
	FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, KHACH_HANG AS CT_DT \
	WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND CT.MA_DT=CT_DT.MA_KH AND CT.LOAI_DT IN (2, 4) AND NVKT.MA_TK LIKE '$MA_TK$%' AND CT.LOAI_DT IN (?) AND CT.NGAY_HT >= ? AND CT.NGAY_HT <= ? \
	GROUP BY CT.MA_DT, CT.LOAI_DT, NVKT.MA_TK, NVKT.SO_DU \
	UNION \
	SELECT CT.MA_DT, CT.LOAI_DT, CT_DT.KH_NCC AS KH_DT, CT_DT.TEN_NCC AS TEN_DT, NVKT.MA_TK, NVKT.SO_DU, SUM(NVKT.SO_TIEN) AS SO_TIEN \
	FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, NHA_CUNG_CAP AS CT_DT \
	WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND CT.MA_DT=CT_DT.MA_NCC AND CT.LOAI_DT IN (3) AND NVKT.MA_TK LIKE '$MA_TK$%' AND CT.LOAI_DT IN (?) AND CT.NGAY_HT >= ? AND CT.NGAY_HT <= ? \
	GROUP BY CT.MA_DT, CT.LOAI_DT, NVKT.MA_TK, NVKT.SO_DU \
	ORDER BY MA_DT, LOAI_DT, MA_TK, SO_DU
TINH_SO_DU_KY_KTTH_THEO_DOI_TUONG=SELECT CT.MA_DT, CT.LOAI_DT, '' AS KH_DT, CT_DT.FULL_NAME COLLATE utf8_general_ci AS TEN_DT, NVKT.MA_TK, NVKT.SO_DU, SUM(NVKT.SO_TIEN) AS SO_TIEN \
	FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, EMPLOYEE_INFO AS CT_DT \
	WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_DT=CT_DT.EMPLOYEE_ID AND NVKT.LOAI_DT IN (1) AND NVKT.MA_TK LIKE '$MA_TK$%' AND NVKT.LOAI_DT IN (?) AND CT.NGAY_HT >= ? AND CT.NGAY_HT <= ? \
	GROUP BY NVKT.MA_DT, NVKT.LOAI_DT, NVKT.MA_TK, NVKT.SO_DU \
	UNION \
	SELECT CT.MA_DT, CT.LOAI_DT, CT_DT.KH_KH AS KH_DT, CT_DT.TEN_KH AS TEN_DT, NVKT.MA_TK, NVKT.SO_DU, SUM(NVKT.SO_TIEN) AS SO_TIEN \
	FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, KHACH_HANG AS CT_DT \
	WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_DT=CT_DT.MA_KH AND NVKT.LOAI_DT IN (2, 4) AND NVKT.MA_TK LIKE '$MA_TK$%' AND NVKT.LOAI_DT IN (?) AND CT.NGAY_HT >= ? AND CT.NGAY_HT <= ? \
	GROUP BY NVKT.MA_DT, NVKT.LOAI_DT, NVKT.MA_TK, NVKT.SO_DU \
	UNION \
	SELECT CT.MA_DT, CT.LOAI_DT, CT_DT.KH_NCC AS KH_DT, CT_DT.TEN_NCC AS TEN_DT, NVKT.MA_TK, NVKT.SO_DU, SUM(NVKT.SO_TIEN) AS SO_TIEN \
	FROM CHUNG_TU AS CT, CHUNG_TU_NVKT AS CTNVKT, NGHIEP_VU_KE_TOAN AS NVKT, NHA_CUNG_CAP AS CT_DT \
	WHERE CT.MA_CT=CTNVKT.MA_CT AND CTNVKT.MA_NVKT=NVKT.MA_NVKT AND NVKT.MA_DT=CT_DT.MA_NCC AND NVKT.LOAI_DT IN (3) AND NVKT.MA_TK LIKE '$MA_TK$%' AND NVKT.LOAI_DT IN (?) AND CT.NGAY_HT >= ? AND CT.NGAY_HT <= ? \
	GROUP BY NVKT.MA_DT, NVKT.LOAI_DT, NVKT.MA_TK, NVKT.SO_DU \
	ORDER BY MA_DT, LOAI_DT, MA_TK, SO_DU
LAY_SO_DU_KY_KHO_THEO_MA_KKT=SELECT KKT.*, SD.NO_DAU_KY, SD.NO_DAU_KY_NT, SD.CO_DAU_KY, SD.CO_DAU_KY_NT, SD.NO_CUOI_KY, SD.NO_CUOI_KY_NT, SD.CO_CUOI_KY, SD.CO_CUOI_KY_NT, SD.SO_LUONG, TK.*, HH.MA_HH, HH.KH_HH, HH.TEN_HH, HHDV.*, HHK.MA_KHO, HHK.KH_KHO, HHK.TEN_KHO, NT.MA_NT, NT.TEN_NT \
	FROM KY_KE_TOAN AS KKT, KY_KE_TOAN_SO_DU AS SD, TAI_KHOAN_DANH_MUC AS TK, HANG_HOA_DANH_MUC AS HH, HANG_HOA_KHO AS HHK, HANG_HOA_DON_VI AS HHDV, HANG_HOA_NHOM AS HHN, NGOAI_TE AS NT \
	WHERE SD.MA_KKT=KKT.MA_KKT AND SD.MA_TK=TK.MA_TK AND HH.MA_HH=SD.MA_HH AND HHK.MA_KHO=SD.MA_KHO AND HHDV.MA_DV=SD.MA_DV AND HH.MA_NHOM_HH=HHN.MA_NHOM_HH AND SD.MA_KKT=? AND SD.MA_DT=0 AND SD.LOAI_DT=0 AND SD.MA_HH <> 0 AND SD.MA_KHO <> 0 AND SD.LOAI_TIEN=NT.MA_NT \
	ORDER BY SD.MA_HH, SD.MA_KHO, SD.MA_TK
LAY_SO_DU_KY_KHO_THEO_MA_KKT_MA_HH_MA_KHO_MA_TK_CON=SELECT KKT.*, SD.NO_DAU_KY, SD.NO_DAU_KY_NT, SD.CO_DAU_KY, SD.CO_DAU_KY_NT, SD.NO_CUOI_KY, SD.NO_CUOI_KY_NT, SD.CO_CUOI_KY, SD.CO_CUOI_KY_NT, SD.SO_LUONG, TK.*, HH.MA_HH, HH.KH_HH, HH.TEN_HH, HHDV.*, HHK.MA_KHO, HHK.KH_KHO, HHK.TEN_KHO, NT.MA_NT, NT.TEN_NT \
	FROM KY_KE_TOAN AS KKT, KY_KE_TOAN_SO_DU AS SD, TAI_KHOAN_DANH_MUC AS TK, HANG_HOA_DANH_MUC AS HH, HANG_HOA_KHO AS HHK, HANG_HOA_DON_VI AS HHDV, HANG_HOA_NHOM AS HHN, NGOAI_TE AS NT \
	WHERE SD.MA_KKT=KKT.MA_KKT AND SD.MA_TK=TK.MA_TK AND HH.MA_HH=SD.MA_HH AND HHK.MA_KHO=SD.MA_KHO AND HHDV.MA_DV=SD.MA_DV AND HH.MA_NHOM_HH=HHN.MA_NHOM_HH AND SD.MA_KKT=? AND SUBSTRING(?, 1, LENGTH(TK.MA_TK))=TK.MA_TK AND HH.MA_HH=? AND HHK.MA_KHO=? AND SD.MA_DT=0 AND SD.LOAI_DT=0 AND SD.MA_HH <> 0 AND SD.MA_KHO <> 0 AND SD.LOAI_TIEN=NT.MA_NT \
	ORDER BY SD.MA_HH, SD.MA_KHO, SD.MA_TK
LAY_SO_DU_KY_KHO_THEO_MA_KKT_MA_TK_MA_KHOS=SELECT KKT.*, SUM(SD.NO_DAU_KY) AS NO_DAU_KY, 0 AS NO_DAU_KY_NT, SUM(SD.CO_DAU_KY) AS CO_DAU_KY, 0 AS CO_DAU_KY_NT, SUM(SD.NO_CUOI_KY) AS NO_CUOI_KY, 0 AS NO_CUOI_KY_NT, SUM(SD.CO_CUOI_KY) AS CO_CUOI_KY, 0 AS CO_CUOI_KY_NT, SUM(SD.SO_LUONG) AS SO_LUONG, TK.*, HH.MA_HH, HH.KH_HH, HH.TEN_HH, HHDV.*, 0 AS MA_KHO, "" AS KH_KHO, "" AS TEN_KHO, "VND" AS MA_NT, "" AS TEN_NT \
	FROM KY_KE_TOAN AS KKT, KY_KE_TOAN_SO_DU AS SD, TAI_KHOAN_DANH_MUC AS TK, HANG_HOA_DANH_MUC AS HH, HANG_HOA_KHO AS HHK, HANG_HOA_DON_VI AS HHDV, HANG_HOA_NHOM AS HHN \
	WHERE SD.MA_KKT=KKT.MA_KKT AND SD.MA_TK=TK.MA_TK AND HH.MA_HH=SD.MA_HH AND HHK.MA_KHO=SD.MA_KHO AND HHDV.MA_DV=SD.MA_DV AND HH.MA_NHOM_HH=HHN.MA_NHOM_HH AND SD.MA_KKT=? AND SD.MA_TK=? $DIEU_KIEN_MA_KHO$ AND SD.MA_DT=0 AND SD.LOAI_DT=0 AND SD.MA_HH <> 0 AND SD.MA_KHO <> 0 \
	GROUP BY SD.MA_HH
LAY_SO_DU_KY_KHO_THEO_MA_KKT_MA_HH_MA_TK_MA_KHOS=SELECT KKT.*, SUM(SD.NO_DAU_KY) AS NO_DAU_KY, 0 AS NO_DAU_KY_NT, SUM(SD.CO_DAU_KY) AS CO_DAU_KY, 0 AS CO_DAU_KY_NT, SUM(SD.NO_CUOI_KY) AS NO_CUOI_KY, 0 AS NO_CUOI_KY_NT, SUM(SD.CO_CUOI_KY) AS CO_CUOI_KY, 0 AS CO_CUOI_KY_NT, SUM(SD.SO_LUONG) AS SO_LUONG, TK.*, HH.MA_HH, HH.KH_HH, HH.TEN_HH, HHDV.*, 0 AS MA_KHO, "" AS KH_KHO, "" AS TEN_KHO, "VND" AS MA_NT, "" AS TEN_NT \
	FROM KY_KE_TOAN AS KKT, KY_KE_TOAN_SO_DU AS SD, TAI_KHOAN_DANH_MUC AS TK, HANG_HOA_DANH_MUC AS HH, HANG_HOA_KHO AS HHK, HANG_HOA_DON_VI AS HHDV, HANG_HOA_NHOM AS HHN \
	WHERE SD.MA_KKT=KKT.MA_KKT AND SD.MA_TK=TK.MA_TK AND HH.MA_HH=SD.MA_HH AND HHK.MA_KHO=SD.MA_KHO AND HHDV.MA_DV=SD.MA_DV AND HH.MA_NHOM_HH=HHN.MA_NHOM_HH AND SD.MA_KKT=? AND SD.MA_TK=? AND HH.MA_HH=? $DIEU_KIEN_MA_KHO$ AND SD.MA_DT=0 AND SD.LOAI_DT=0 AND SD.MA_HH <> 0 AND SD.MA_KHO <> 0 \
	GROUP BY SD.MA_HH
LAY_SO_DU_KY_KHO_THEO_MA_KKT_MA_HH_MA_TK_MA_KHO=SELECT KKT.*, SD.NO_DAU_KY, SD.NO_DAU_KY_NT, SD.CO_DAU_KY, SD.CO_DAU_KY_NT, SD.NO_CUOI_KY, SD.NO_CUOI_KY_NT, SD.CO_CUOI_KY, SD.CO_CUOI_KY_NT, SD.SO_LUONG, TK.*, HH.MA_HH, HH.KH_HH, HH.TEN_HH, HHDV.*, HHK.MA_KHO, HHK.KH_KHO, HHK.TEN_KHO, NT.MA_NT, NT.TEN_NT \
	FROM KY_KE_TOAN AS KKT, KY_KE_TOAN_SO_DU AS SD, TAI_KHOAN_DANH_MUC AS TK, HANG_HOA_DANH_MUC AS HH, HANG_HOA_KHO AS HHK, HANG_HOA_DON_VI AS HHDV, HANG_HOA_NHOM AS HHN, NGOAI_TE AS NT \
	WHERE SD.MA_KKT=KKT.MA_KKT AND SD.MA_TK=TK.MA_TK AND HH.MA_HH=SD.MA_HH AND HHK.MA_KHO=SD.MA_KHO AND HHDV.MA_DV=SD.MA_DV AND HH.MA_NHOM_HH=HHN.MA_NHOM_HH AND SD.MA_KKT=? AND TK.MA_TK=? AND HH.MA_HH=? AND HHK.MA_KHO=? AND SD.MA_DT=0 AND SD.LOAI_DT=0 AND SD.MA_HH <> 0 AND SD.MA_KHO <> 0 AND SD.LOAI_TIEN=NT.MA_NT
THEM_SO_DU_KY=INSERT INTO KY_KE_TOAN_SO_DU (MA_KKT, MA_TK, LOAI_DT, MA_DT, MA_HH, MA_KHO, NO_DAU_KY, NO_DAU_KY_NT, CO_DAU_KY, CO_DAU_KY_NT, LOAI_TIEN, SO_LUONG, MA_DV) VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
CAP_NHAT_SO_DU_DAU_KY=UPDATE KY_KE_TOAN_SO_DU SET NO_DAU_KY=?, NO_DAU_KY_NT=?, CO_DAU_KY=?, CO_DAU_KY_NT=?, LOAI_TIEN=?, SO_LUONG=?, MA_DV=? WHERE MA_KKT=? AND MA_TK=? AND LOAI_DT=? AND MA_DT=? AND MA_HH=? AND MA_KHO=?
XOA_SO_DU_DAU_KY=DELETE FROM KY_KE_TOAN_SO_DU WHERE MA_KKT=? AND MA_TK=? AND LOAI_DT=? AND MA_DT=? AND MA_HH=? AND MA_KHO=?

## QUẢN LÝ HÀNG HÓA
# Đơn vị tính
DANH_SACH_DON_VI=SELECT * FROM HANG_HOA_DON_VI
DANH_SACH_DON_VI_PHAT_SINH=SELECT DISTINCT MA_DV, "" AS TEN_DV, "" AS MO_TA FROM HANG_HOA_DANH_MUC WHERE MA_DV IS NOT NULL AND MA_DV!=0
DANH_SACH_DON_VI_SO_DU_KY=SELECT DISTINCT MA_DV, "" AS TEN_DV, "" AS MO_TA FROM KY_KE_TOAN_SO_DU WHERE MA_DV IS NOT NULL AND MA_DV!=0
KIEM_TRA_DON_VI_PHAT_SINH=SELECT COUNT(*) FROM HANG_HOA_DANH_MUC WHERE MA_DV=?
KIEM_TRA_DON_VI_SO_DU_KY=SELECT COUNT(*) FROM KY_KE_TOAN_SO_DU WHERE MA_DV=?
LAY_DON_VI=SELECT * FROM HANG_HOA_DON_VI WHERE MA_DV=?
CAP_NHAT_DON_VI=UPDATE HANG_HOA_DON_VI SET TEN_DV=?, MO_TA=? WHERE MA_DV=?
THEM_DON_VI=INSERT INTO HANG_HOA_DON_VI(TEN_DV, MO_TA) VALUES(?, ?)

# Nhóm hàng hóa
DANH_SACH_NHOM_HANG_HOA_THEO_CHA=SELECT * FROM HANG_HOA_NHOM WHERE MA_NHOM_HH_CHA=? OR MA_NHOM_HH_CHA IS NULL
DANH_SACH_NHOM_HANG_HOA=SELECT * FROM HANG_HOA_NHOM ORDER BY TEN_NHOM_HH
DANH_SACH_NHOM_HANG_HOA_PHAT_SINH=SELECT DISTINCT MA_NHOM_HH, "" AS KH_NHOM_HH, "" AS TEN_NHOM_HH, 0 AS MA_NHOM_HH_CHA FROM HANG_HOA_DANH_MUC \
	WHERE MA_NHOM_HH IS NOT NULL AND MA_NHOM_HH!=0
DANH_SACH_NHOM_HANG_HOA_CHA=SELECT DISTINCT MA_NHOM_HH_CHA AS MA_NHOM_HH, "" AS KH_NHOM_HH, "" AS TEN_NHOM_HH, 0 AS MA_NHOM_HH_CHA FROM HANG_HOA_NHOM AS HHN \
	WHERE HHN.MA_NHOM_HH_CHA IS NOT NULL AND HHN.MA_NHOM_HH_CHA!=0
KIEM_TRA_NHOM_HANG_HOA_PHAT_SINH=SELECT COUNT(*) FROM HANG_HOA_DANH_MUC WHERE MA_NHOM_HH=?
KIEM_TRA_NHOM_HANG_HOA_CHA=SELECT COUNT(*) FROM HANG_HOA_NHOM WHERE MA_NHOM_HH_CHA=?
LAY_NHOM_HANG_HOA=SELECT * FROM HANG_HOA_NHOM WHERE MA_NHOM_HH=?
CAP_NHAT_NHOM_HANG_HOA=UPDATE HANG_HOA_NHOM SET KH_NHOM_HH=?, TEN_NHOM_HH=?, MA_NHOM_HH_CHA=? WHERE MA_NHOM_HH=?
THEM_NHOM_HANG_HOA=INSERT INTO HANG_HOA_NHOM(KH_NHOM_HH, TEN_NHOM_HH, MA_NHOM_HH_CHA) VALUES(?, ?, ?)

# Hàng hóa
DANH_SACH_HANG_HOA=SELECT HH.*, HH_DV.TEN_DV, HH_DV.MO_TA, HH_N.KH_NHOM_HH, HH_N.TEN_NHOM_HH FROM HANG_HOA_DANH_MUC AS HH, HANG_HOA_DON_VI AS HH_DV, HANG_HOA_NHOM AS HH_N WHERE HH.MA_DV=HH_DV.MA_DV AND HH.MA_NHOM_HH=HH_N.MA_NHOM_HH
DANH_SACH_HANG_HOA_PHAT_SINH=SELECT DISTINCT MA_HH FROM CHUNG_TU_HANG_HOA WHERE MA_HH IS NOT NULL AND MA_HH!=0
KIEM_TRA_HANG_HOA_PHAT_SINH=SELECT COUNT(*) FROM CHUNG_TU_HANG_HOA WHERE MA_HH=?
DANH_SACH_HANG_HOA_THEO_TEN=SELECT HH.*, HH_DV.TEN_DV, HH_DV.MO_TA, HH_N.KH_NHOM_HH, HH_N.TEN_NHOM_HH FROM HANG_HOA_DANH_MUC AS HH, HANG_HOA_DON_VI AS HH_DV, HANG_HOA_NHOM AS HH_N WHERE HH.MA_DV=HH_DV.MA_DV AND HH.MA_NHOM_HH=HH_N.MA_NHOM_HH AND (TEN_HH LIKE '%?%' OR KH_HH LIKE '%?%')
DANH_SACH_KH_HANG_HOA=SELECT MA_HH, KH_HH, TEN_HH FROM HANG_HOA_DANH_MUC
LAY_HANG_HOA=SELECT HH.*, HH_DV.TEN_DV, HH_DV.MO_TA, HH_N.KH_NHOM_HH, HH_N.TEN_NHOM_HH FROM HANG_HOA_DANH_MUC AS HH, HANG_HOA_DON_VI AS HH_DV, HANG_HOA_NHOM AS HH_N WHERE HH.MA_DV=HH_DV.MA_DV AND HH.MA_NHOM_HH=HH_N.MA_NHOM_HH AND HH.MA_HH=?
KIEM_TRA_KH_HH=SELECT COUNT(*) FROM HANG_HOA_DANH_MUC AS HH WHERE KH_HH=? AND MA_HH!=?
CAP_NHAT_HANG_HOA=UPDATE HANG_HOA_DANH_MUC SET KH_HH=?, TEN_HH=?, MA_DV=?, MA_NHOM_HH=?, TINH_CHAT=?, MO_TA=?, NGUON_GOC=?, THOI_HAN_BH=?, MA_KHO=?, MA_TK_KHO=?, MA_TK_DT=?, MA_TK_CP=?, MA_TK_CK=?, MA_TK_GG=?, MA_TK_TL=?, TY_LE_CKTM=?, THUE_SUAT_GTGT=?, THUE_SUAT_XK=?, THUE_SUAT_NK=?, THUE_SUAT_TTDB=? WHERE MA_HH=?
THEM_HANG_HOA=INSERT INTO HANG_HOA_DANH_MUC(KH_HH, TEN_HH, MA_DV, MA_NHOM_HH, TINH_CHAT, MO_TA, NGUON_GOC, THOI_HAN_BH, MA_KHO, MA_TK_KHO, MA_TK_DT, MA_TK_CP, MA_TK_CK, MA_TK_GG, MA_TK_TL, TY_LE_CKTM, THUE_SUAT_GTGT, THUE_SUAT_XK, THUE_SUAT_NK, THUE_SUAT_TTDB) VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)

# Kho bãi
DANH_SACH_KHO=SELECT * FROM HANG_HOA_KHO WHERE MA_KHO!=0 ORDER BY TEN_KHO
DANH_SACH_KHO_PHAT_SINH=SELECT MA_KHO, "" AS KH_KHO, "" AS TEN_KHO, "" AS DIA_CHI, "" AS MO_TA FROM CHUNG_TU_HANG_HOA WHERE MA_KHO IS NOT NULL AND MA_KHO!=0
DANH_SACH_KHO_MAC_DINH=SELECT MA_KHO, "" AS KH_KHO, "" AS TEN_KHO, "" AS DIA_CHI, "" AS MO_TA FROM HANG_HOA_DANH_MUC WHERE MA_KHO IS NOT NULL AND MA_KHO!=0
KIEM_TRA_KHO_PHAT_SINH=SELECT COUNT(*) FROM CHUNG_TU_HANG_HOA WHERE MA_KHO=?
KIEM_TRA_KHO_MAC_DINH=SELECT COUNT(*) FROM HANG_HOA_DANH_MUC WHERE MA_KHO=?
LAY_KHO=SELECT * FROM HANG_HOA_KHO WHERE MA_KHO=?
CAP_NHAT_KHO=UPDATE HANG_HOA_KHO SET KH_KHO=?, TEN_KHO=?, DIA_CHI=?, MO_TA=? WHERE MA_KHO=?
THEM_KHO=INSERT INTO HANG_HOA_KHO(KH_KHO, TEN_KHO, DIA_CHI, MO_TA) VALUES(?, ?, ?, ?)

## QUẢN LÝ NGÂN HÀNG, TÀI KHOẢN NGÂN HÀNG
# Ngân hàng
DANH_SACH_NGAN_HANG=SELECT * FROM NGAN_HANG
LAY_NGAN_HANG=SELECT * FROM NGAN_HANG WHERE MA_NH=?
THEM_NGAN_HANG=INSERT INTO NGAN_HANG(TEN_VT, TEN_DD, TEN_TA, DIA_CHI_HSC, BIEU_TUONG, MO_TA) VALUES(?, ?, ?, ?, ?, ?)
CAP_NHAT_NGAN_HANG=UPDATE NGAN_HANG SET TEN_VT=?, TEN_DD=?, TEN_TA=?, DIA_CHI_HSC=?, BIEU_TUONG=?, MO_TA=? WHERE MA_NH=?
XOA_NGAN_HANG= DELETE FROM NGAN_HANG WHERE MA_NH=?
XOA_NGAN_HANG_TAI_KHOAN_THEONH=DELETE FROM NGAN_HANG_TAI_KHOAN WHERE MA_NH=?

DANH_SACH_TAI_KHOAN_NGAN_HANG=SELECT TK.*, NH.TEN_VT, NH.TEN_DD FROM NGAN_HANG_TAI_KHOAN AS TK, NGAN_HANG AS NH WHERE TK.MA_NH=NH.MA_NH
LAY_NGAN_HANG_TAI_KHOAN=SELECT TK.*, NH.TEN_VT, NH.TEN_DD FROM NGAN_HANG_TAI_KHOAN AS TK, NGAN_HANG AS NH WHERE TK.MA_NH=NH.MA_NH AND MA_TK=?
THEM_NGAN_HANG_TAI_KHOAN=INSERT INTO NGAN_HANG_TAI_KHOAN(SO_TK, MA_NH, CHI_NHANH, DIA_CHI, CHU_TK, MO_TA) VALUES(?, ?, ?, ?, ?, ?)
CAP_NHAT_NGAN_HANG_TAI_KHOAN=UPDATE NGAN_HANG_TAI_KHOAN SET SO_TK=?, MA_NH=?, CHI_NHANH=?, DIA_CHI=?, CHU_TK=?, MO_TA=? WHERE MA_TK=?
XOA_NGAN_HANG_TAI_KHOAN=DELETE FROM NGAN_HANG_TAI_KHOAN WHERE MA_TK=?

## QUẢN LÝ ĐỊA CHỈ, VÙNG MIỀN
LAY_VUNG_DIA_CHI=SELECT VUNG.*, CAP.TEN_CAP_DC, CAP.MO_TA, CAP.CAP_DC FROM DIA_CHI_VUNG AS VUNG, DIA_CHI_CAP AS CAP WHERE VUNG.MA_VUNG_DC=? AND VUNG.MA_CAP_DC=CAP.MA_CAP_DC
DANH_SACH_CAP_DIA_CHI=SELECT * FROM DIA_CHI_CAP AS CAP WHERE CAP_DC=? ORDER BY MA_CAP_DC
DANH_SACH_VUNG_DIA_CHI_THEO_CHA=SELECT VUNG.*, CAP.TEN_CAP_DC, CAP.MO_TA, CAP.CAP_DC FROM DIA_CHI_VUNG AS VUNG, DIA_CHI_CAP AS CAP WHERE $DIEU_KIEN_VUNG_CHA$ AND VUNG.MA_CAP_DC=CAP.MA_CAP_DC ORDER BY VUNG.MA_VUNG_DC
DANH_SACH_VUNG_DIA_CHI_THEO_CAP=SELECT VUNG.*, CAP.TEN_CAP_DC, CAP.MO_TA, CAP.CAP_DC FROM DIA_CHI_VUNG AS VUNG, DIA_CHI_CAP AS CAP WHERE VUNG.MA_CAP_DC=CAP.MA_CAP_DC AND CAP.CAP_DC=? $DIEU_KIEN_KHAC$ ORDER BY MA_VUNG_DC_CHA, VUNG.MA_VUNG_DC $DIEU_KIEN_GIOI_HAN$
LAY_MA_VUNG_DIA_CHI_CON=SELECT DISTINCT MA_VUNG_DC FROM DIA_CHI_VUNG WHERE MA_VUNG_DC_CHA IN (?)
DEM_SO_VUNG_DIA_CHI_THEO_CAP=SELECT COUNT(*) FROM DIA_CHI_VUNG AS VUNG, DIA_CHI_CAP AS CAP WHERE VUNG.MA_CAP_DC=CAP.MA_CAP_DC AND CAP.CAP_DC=? $DIEU_KIEN_KHAC$
THEM_VUNG_DIA_CHI=INSERT INTO DIA_CHI_VUNG (MA_VUNG_DC, TEN_VUNG_DC, MA_VUNG_DC_CHA, MA_CAP_DC) VALUES (?, ?, ?, ?)
CAP_NHAT_VUNG_DIA_CHI=UPDATE DIA_CHI_VUNG SET TEN_VUNG_DC=?, MA_VUNG_DC_CHA=?, MA_CAP_DC=? WHERE MA_VUNG_DC=?

